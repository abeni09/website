/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[14,4,11,20,22],{463:function(e,t,n){"use strict";var r=n(307);t.a=r.a},810:function(e,t,n){"use strict";n.r(t);var r=n(307),o=n(297),l=n(296),c=n(795),h=n(21),d=(n(61),n(33),n(45),n(23),n(3),n(81),n(126),{computed:{getUploadingMessage:function(){return this.uploading?"Uploading ".concat(this.label," ..."):"Upload ".concat(this.label)}},props:{uploadUrl:{type:String,required:!0},label:{type:String,required:!0},memberId:{type:Number},imageName:{type:String}},data:function(){return{uploading:!1,snackbar:!1,snackBarText:"",timeout:2e3,errorMessage:"",imageUrl:""}},methods:{launchProPicFile:function(){this.$refs.fileInput.click()},setSnackbarMessage:function(e){this.snackbar=!0,this.snackBarText=e},handleFileChange:function(e){var t=this;return Object(h.a)(regeneratorRuntime.mark((function n(){var r,o,l,c,h,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.target.files[0]){n.next=6;break}return t.errorMessage="No file selected",t.$refs.fileInput.value="",t.setSnackbarMessage(t.errorMessage),n.abrupt("return");case 6:if(r.type.startsWith("image/")){n.next=11;break}return t.errorMessage="Selected file is not an image",t.$refs.fileInput.value="",t.setSnackbarMessage(t.errorMessage),n.abrupt("return");case 11:return t.uploading=!0,o=new FormData,l=t.memberId?"".concat(t.memberId,"-").concat(t.imageName,".").concat(r.name.split(".").pop()):"".concat(t.imageName,".").concat(r.name.split(".").pop()),c=new File([r],l,{type:r.type}),o.append("file",c),o.append("memberId",t.memberId),o.append("imageName",t.imageName),n.prev=18,n.next=21,fetch("".concat(t.uploadUrl,"/uploadImage"),{method:"POST",body:o});case 21:if((h=n.sent).ok){n.next=24;break}throw new Error("Failed to upload image");case 24:return n.next=26,h.json();case 26:d=n.sent,console.log(d),d.filename&&(t.imageUrl="".concat(t.uploadUrl,"/").concat(d.filename)),t.$refs.fileInput.value="",t.setSnackbarMessage("Image uploaded successfully"),t.uploading=!1,n.next=40;break;case 34:n.prev=34,n.t0=n.catch(18),console.error("Error uploading image:",n.t0.message),t.$refs.fileInput.value="",t.setSnackbarMessage(n.t0.message),t.uploading=!1;case 40:case"end":return n.stop()}}),n,null,[[18,34]])})))()}}}),f=n(100),component=Object(f.a)(d,(function(){var e=this,t=e._self._c;return t("div",[t(c.a,{attrs:{timeout:e.timeout},scopedSlots:e._u([{key:"actions",fn:function(){return[t(r.a,{attrs:{color:"pink",variant:"text"},on:{click:function(t){e.snackbar=!1}}},[e._v("\n      Close\n    ")])]},proxy:!0}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n  "+e._s(e.snackBarText)+"\n\n  ")]),e._v(" "),t(o.a,{attrs:{disabled:e.uploading},on:{click:e.launchProPicFile}},[t("input",{ref:"fileInput",staticStyle:{width:"0",height:"0"},attrs:{required:"",type:"file"},on:{change:e.handleFileChange}}),e._v(" "),t("h2",{staticStyle:{"text-align":"center"}},[t("p",[e._v(e._s(e.getUploadingMessage))]),e._v(" "),t(l.a,{staticStyle:{"align-self":"center"},attrs:{size:"50"}},[e._v("mdi-upload")])],1)])],1)}),[],!1,null,null,null);t.default=component.exports},813:function(e,t,n){var content=n(814);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("0f3c9f10",content,!0,{sourceMap:!1})},814:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,".theme--light.v-data-table tbody tr.v-data-table__selected{background:#f5f5f5}.theme--light.v-data-table .v-row-group__header,.theme--light.v-data-table .v-row-group__summary{background:#eee}.theme--light.v-data-table .v-data-footer{border-top:thin solid rgba(0,0,0,.12)}.theme--light.v-data-table .v-data-table__empty-wrapper{color:rgba(0,0,0,.38)}.theme--dark.v-data-table tbody tr.v-data-table__selected{background:#505050}.theme--dark.v-data-table .v-row-group__header,.theme--dark.v-data-table .v-row-group__summary{background:#616161}.theme--dark.v-data-table .v-data-footer{border-top:thin solid hsla(0,0%,100%,.12)}.theme--dark.v-data-table .v-data-table__empty-wrapper{color:hsla(0,0%,100%,.5)}.v-data-table{border-radius:4px}.v-data-table--mobile>.v-data-table__wrapper tbody{display:flex;flex-direction:column}.v-data-table>.v-data-table__wrapper tbody tr.v-data-table__expanded{border-bottom:0}.v-data-table>.v-data-table__wrapper tbody tr.v-data-table__expanded__content{box-shadow:inset 0 4px 8px -5px rgba(50,50,50,.75),inset 0 -4px 8px -5px rgba(50,50,50,.75)}.v-data-table>.v-data-table__wrapper tbody tr:first-child:hover td:first-child{border-top-left-radius:4px}.v-data-table>.v-data-table__wrapper tbody tr:first-child:hover td:last-child{border-top-right-radius:4px}.v-data-table>.v-data-table__wrapper tbody tr:last-child:hover td:first-child{border-bottom-left-radius:4px}.v-data-table>.v-data-table__wrapper tbody tr:last-child:hover td:last-child{border-bottom-right-radius:4px}.v-data-table>.v-data-table__wrapper .v-data-table__mobile-table-row{display:inline;display:initial}.v-data-table>.v-data-table__wrapper .v-data-table__mobile-row{height:auto;min-height:48px}.v-data-table__empty-wrapper{text-align:center}.v-data-table__mobile-row{align-items:center;display:flex;justify-content:space-between}.v-data-table__mobile-row__header{font-weight:600}.v-application--is-ltr .v-data-table__mobile-row__header{padding-right:16px}.v-application--is-rtl .v-data-table__mobile-row__header{padding-left:16px}.v-application--is-ltr .v-data-table__mobile-row__cell{text-align:right}.v-application--is-rtl .v-data-table__mobile-row__cell{text-align:left}.v-row-group__header td,.v-row-group__summary td{height:35px}.v-data-table__expand-icon{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}.v-data-table__expand-icon--active{transform:rotate(-180deg)}",""]),r.locals={},e.exports=r},815:function(e,t,n){var content=n(816);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("7cf76dc8",content,!0,{sourceMap:!1})},816:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,".v-data-footer{align-items:center;display:flex;flex-wrap:wrap;font-size:.75rem;padding:0 8px}.v-data-footer .v-btn{color:inherit}.v-application--is-ltr .v-data-footer__icons-before .v-btn:last-child{margin-right:7px}.v-application--is-ltr .v-data-footer__icons-after .v-btn:first-child,.v-application--is-rtl .v-data-footer__icons-before .v-btn:last-child{margin-left:7px}.v-application--is-rtl .v-data-footer__icons-after .v-btn:first-child{margin-right:7px}.v-data-footer__pagination{display:block;text-align:center}.v-application--is-ltr .v-data-footer__pagination{margin:0 32px 0 24px}.v-application--is-rtl .v-data-footer__pagination{margin:0 24px 0 32px}.v-data-footer__select{align-items:center;display:flex;flex:0 0 0;justify-content:flex-end;white-space:nowrap}.v-application--is-ltr .v-data-footer__select{margin-left:auto;margin-right:14px}.v-application--is-rtl .v-data-footer__select{margin-left:14px;margin-right:auto}.v-data-footer__select .v-select{flex:0 1 0;padding:0;position:static}.v-application--is-ltr .v-data-footer__select .v-select{margin:13px 0 13px 34px}.v-application--is-rtl .v-data-footer__select .v-select{margin:13px 34px 13px 0}.v-data-footer__select .v-select__selections{flex-wrap:nowrap}.v-data-footer__select .v-select__selections .v-select__selection--comma{font-size:.75rem}",""]),r.locals={},e.exports=r},817:function(e,t,n){var content=n(818);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("6af7f350",content,!0,{sourceMap:!1})},818:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,".theme--light.v-data-table .v-data-table-header th.sortable .v-data-table-header__icon{color:rgba(0,0,0,.38)}.theme--light.v-data-table .v-data-table-header th.sortable.active,.theme--light.v-data-table .v-data-table-header th.sortable.active .v-data-table-header__icon,.theme--light.v-data-table .v-data-table-header th.sortable:hover{color:rgba(0,0,0,.87)}.theme--light.v-data-table .v-data-table-header__sort-badge{background-color:rgba(0,0,0,.12);color:rgba(0,0,0,.87)}.theme--dark.v-data-table .v-data-table-header th.sortable .v-data-table-header__icon{color:hsla(0,0%,100%,.5)}.theme--dark.v-data-table .v-data-table-header th.sortable.active,.theme--dark.v-data-table .v-data-table-header th.sortable.active .v-data-table-header__icon,.theme--dark.v-data-table .v-data-table-header th.sortable:hover{color:#fff}.theme--dark.v-data-table .v-data-table-header__sort-badge{background-color:hsla(0,0%,100%,.12);color:#fff}.v-data-table-header th.sortable{cursor:pointer;outline:0;pointer-events:auto}.v-data-table-header th.sortable .v-data-table-header__icon{line-height:.9}.v-data-table-header th.active .v-data-table-header__icon,.v-data-table-header th:hover .v-data-table-header__icon{opacity:1;transform:none}.v-data-table-header th.desc .v-data-table-header__icon{transform:rotate(-180deg)}.v-data-table-header__icon{display:inline-block;opacity:0;transition:.3s cubic-bezier(.25,.8,.5,1)}.v-data-table-header__sort-badge{align-items:center;border:0;border-radius:50%;display:inline-flex;height:18px;justify-content:center;min-height:18px;min-width:18px;width:18px}.v-data-table-header-mobile th{height:auto}.v-data-table-header-mobile__wrapper{display:flex}.v-data-table-header-mobile__wrapper .v-select{margin-bottom:8px}.v-data-table-header-mobile__wrapper .v-select .v-chip{height:24px}.v-data-table-header-mobile__wrapper .v-select .v-chip__close.desc .v-icon{transform:rotate(-180deg)}.v-data-table-header-mobile__select{align-items:center;display:flex;justify-content:center;min-width:56px}",""]),r.locals={},e.exports=r},819:function(e,t,n){var content=n(820);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("2f710ab8",content,!0,{sourceMap:!1})},820:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,".theme--light.v-data-table{background-color:#fff;color:rgba(0,0,0,.87)}.theme--light.v-data-table .v-data-table__divider{border-right:thin solid rgba(0,0,0,.12)}.theme--light.v-data-table.v-data-table--fixed-header thead th{background:#fff;box-shadow:inset 0 -1px 0 rgba(0,0,0,.12)}.theme--light.v-data-table>.v-data-table__wrapper>table>thead>tr>th{color:rgba(0,0,0,.6)}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:last-child,.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:not(.v-data-table__mobile-row),.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:last-child,.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:not(.v-data-table__mobile-row),.theme--light.v-data-table>.v-data-table__wrapper>table>thead>tr:last-child>th{border-bottom:thin solid rgba(0,0,0,.12)}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr.active{background:#f5f5f5}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){background:#eee}.theme--light.v-data-table>.v-data-table__wrapper>table>tfoot>tr>td:not(.v-data-table__mobile-row),.theme--light.v-data-table>.v-data-table__wrapper>table>tfoot>tr>th:not(.v-data-table__mobile-row){border-top:thin solid rgba(0,0,0,.12)}.theme--dark.v-data-table{background-color:#1e1e1e;color:#fff}.theme--dark.v-data-table .v-data-table__divider{border-right:thin solid hsla(0,0%,100%,.12)}.theme--dark.v-data-table.v-data-table--fixed-header thead th{background:#1e1e1e;box-shadow:inset 0 -1px 0 hsla(0,0%,100%,.12)}.theme--dark.v-data-table>.v-data-table__wrapper>table>thead>tr>th{color:hsla(0,0%,100%,.7)}.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:last-child,.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:not(.v-data-table__mobile-row),.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:last-child,.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:not(.v-data-table__mobile-row),.theme--dark.v-data-table>.v-data-table__wrapper>table>thead>tr:last-child>th{border-bottom:thin solid hsla(0,0%,100%,.12)}.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr.active{background:#505050}.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){background:#616161}.theme--dark.v-data-table>.v-data-table__wrapper>table>tfoot>tr>td:not(.v-data-table__mobile-row),.theme--dark.v-data-table>.v-data-table__wrapper>table>tfoot>tr>th:not(.v-data-table__mobile-row){border-top:thin solid hsla(0,0%,100%,.12)}.v-data-table{line-height:1.5;max-width:100%}.v-data-table>.v-data-table__wrapper>table{border-spacing:0;width:100%}.v-data-table>.v-data-table__wrapper>table>tbody>tr>td,.v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>td,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-data-table>.v-data-table__wrapper>table>thead>tr>td,.v-data-table>.v-data-table__wrapper>table>thead>tr>th{padding:0 16px;transition:height .2s cubic-bezier(.4,0,.6,1)}.v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-data-table>.v-data-table__wrapper>table>thead>tr>th{font-size:.75rem;height:48px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.v-application--is-ltr .v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-application--is-ltr .v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-application--is-ltr .v-data-table>.v-data-table__wrapper>table>thead>tr>th{text-align:left}.v-application--is-rtl .v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-application--is-rtl .v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-application--is-rtl .v-data-table>.v-data-table__wrapper>table>thead>tr>th{text-align:right}.v-data-table>.v-data-table__wrapper>table>tbody>tr>td,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>td,.v-data-table>.v-data-table__wrapper>table>thead>tr>td{font-size:.875rem;height:48px}.v-data-table__wrapper{overflow-x:auto;overflow-y:hidden}.v-data-table__progress{height:auto!important}.v-data-table__progress th{border:none!important;height:auto!important;padding:0;position:relative}.v-data-table--dense>.v-data-table__wrapper>table>tbody>tr>td,.v-data-table--dense>.v-data-table__wrapper>table>tbody>tr>th,.v-data-table--dense>.v-data-table__wrapper>table>tfoot>tr>td,.v-data-table--dense>.v-data-table__wrapper>table>tfoot>tr>th,.v-data-table--dense>.v-data-table__wrapper>table>thead>tr>td,.v-data-table--dense>.v-data-table__wrapper>table>thead>tr>th{height:32px}.v-data-table--has-top>.v-data-table__wrapper>table>tbody>tr:first-child:hover>td:first-child{border-top-left-radius:0}.v-data-table--has-top>.v-data-table__wrapper>table>tbody>tr:first-child:hover>td:last-child{border-top-right-radius:0}.v-data-table--has-bottom>.v-data-table__wrapper>table>tbody>tr:last-child:hover>td:first-child{border-bottom-left-radius:0}.v-data-table--has-bottom>.v-data-table__wrapper>table>tbody>tr:last-child:hover>td:last-child{border-bottom-right-radius:0}.v-data-table--fixed-header>.v-data-table__wrapper,.v-data-table--fixed-height .v-data-table__wrapper{overflow-y:auto}.v-data-table--fixed-header>.v-data-table__wrapper>table>thead>tr>th{border-bottom:0!important;position:sticky;top:0;z-index:2}.v-data-table--fixed-header>.v-data-table__wrapper>table>thead>tr:nth-child(2)>th{top:48px}.v-application--is-ltr .v-data-table--fixed-header .v-data-footer{margin-right:17px}.v-application--is-rtl .v-data-table--fixed-header .v-data-footer{margin-left:17px}.v-data-table--fixed-header.v-data-table--dense>.v-data-table__wrapper>table>thead>tr:nth-child(2)>th{top:32px}",""]),r.locals={},e.exports=r},824:function(e,t,n){"use strict";n.r(t);var r=n(803);n.d(t,"default",(function(){return r.a}));r.a.registerVersion("firebase","9.23.0","app-compat")},832:function(e,t,n){"use strict";var r=n(4),o=n(833).start;r({target:"String",proto:!0,forced:n(834)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},833:function(e,t,n){"use strict";var r=n(17),o=n(125),l=n(36),c=n(313),h=n(62),d=r(c),f=r("".slice),_=Math.ceil,m=function(e){return function(t,n,r){var c,m,v=l(h(t)),y=o(n),w=v.length,O=void 0===r?" ":l(r);return y<=w||""===O?v:((m=d(O,_((c=y-w)/O.length))).length>c&&(m=f(m,0,c)),e?v+m:m+v)}};e.exports={start:m(!1),end:m(!0)}},834:function(e,t,n){"use strict";var r=n(102);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},835:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return Qi})),n.d(t,"b",(function(){return Yi})),n.d(t,"c",(function(){return Tt})),n.d(t,"d",(function(){return es})),n.d(t,"e",(function(){return Ks})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return si})),n.d(t,"h",(function(){return ai})),n.d(t,"i",(function(){return is})),n.d(t,"j",(function(){return Zs})),n.d(t,"k",(function(){return no})),n.d(t,"l",(function(){return Cs})),n.d(t,"m",(function(){return xs})),n.d(t,"n",(function(){return Ws})),n.d(t,"o",(function(){return Xs})),n.d(t,"p",(function(){return Js})),n.d(t,"q",(function(){return us})),n.d(t,"r",(function(){return eo})),n.d(t,"s",(function(){return to})),n.d(t,"t",(function(){return so})),n.d(t,"u",(function(){return Es})),n.d(t,"v",(function(){return Ns})),n.d(t,"w",(function(){return ys})),n.d(t,"x",(function(){return gs})),n.d(t,"y",(function(){return ms})),n.d(t,"z",(function(){return bs})),n.d(t,"A",(function(){return vs})),n.d(t,"B",(function(){return _s})),n.d(t,"C",(function(){return Ms})),n.d(t,"D",(function(){return Fs})),n.d(t,"E",(function(){return Ls})),n.d(t,"F",(function(){return qs})),n.d(t,"G",(function(){return ss})),n.d(t,"H",(function(){return Hs})),n.d(t,"I",(function(){return ns})),n.d(t,"J",(function(){return rs})),n.d(t,"K",(function(){return os})),n.d(t,"L",(function(){return ao})),n.d(t,"M",(function(){return io})),n.d(t,"N",(function(){return as})),n.d(t,"O",(function(){return ls})),n.d(t,"P",(function(){return cs})),n.d(t,"Q",(function(){return Ts})),n.d(t,"R",(function(){return Is})),n.d(t,"S",(function(){return hs}));var r=n(806),o=n(802),l=n(801),c=n(807);const h="@firebase/database",d="0.14.4";let f="";function _(e){f=e}class m{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(l.R)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(l.K)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class v{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return Object(l.l)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const y=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new m(t)}}catch(e){}return new v},w=y("localStorage"),O=y("sessionStorage"),C=new c.b("@firebase/database"),S=function(){let e=1;return function(){return e++}}(),x=function(e){const t=Object(l.Q)(e),n=new l.d;n.update(t);const r=n.digest();return l.h.encodeByteArray(r)},k=function(...e){let t="";for(let i=0;i<e.length;i++){const n=e[i];Array.isArray(n)||n&&"object"==typeof n&&"number"==typeof n.length?t+=k.apply(null,n):t+="object"==typeof n?Object(l.R)(n):n,t+=" "}return t};let I=null,P=!0;const T=function(e,t){Object(l.f)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(C.logLevel=c.a.VERBOSE,I=C.log.bind(C),t&&O.set("logging_enabled",!0)):"function"==typeof e?I=e:(I=null,O.remove("logging_enabled"))},j=function(...e){if(!0===P&&(P=!1,null===I&&!0===O.get("logging_enabled")&&T(!0)),I){const t=k.apply(null,e);I(t)}},E=function(e){return function(...t){j(e,...t)}},D=function(...e){const t="FIREBASE INTERNAL ERROR: "+k(...e);C.error(t)},N=function(...e){const t=`FIREBASE FATAL ERROR: ${k(...e)}`;throw C.error(t),new Error(t)},R=function(...e){const t="FIREBASE WARNING: "+k(...e);C.warn(t)},M=function(data){return"number"==typeof data&&(data!=data||data===Number.POSITIVE_INFINITY||data===Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",F="[MAX_NAME]",U=function(a,b){if(a===b)return 0;if(a===A||b===F)return-1;if(b===A||a===F)return 1;{const e=G(a),t=G(b);return null!==e?null!==t?e-t==0?a.length-b.length:e-t:-1:null!==t?1:a<b?-1:1}},L=function(a,b){return a===b?0:a<b?-1:1},$=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(l.R)(t))},B=function(e){if("object"!=typeof e||null===e)return Object(l.R)(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=Object(l.R)(t[i]),n+=":",n+=B(e[t[i]]);return n+="}",n},W=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let o=0;o<n;o+=t)o+t>n?r.push(e.substring(o,n)):r.push(e.substring(o,o+t));return r};function H(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const z=function(e){Object(l.f)(!M(e),"Invalid JSON number");const t=1023;let s,n,r,o,i;0===e?(n=0,r=0,s=1/e==-1/0?1:0):(s=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),t),n=o+t,r=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const c=[];for(i=52;i;i-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(i=11;i;i-=1)c.push(n%2?1:0),n=Math.floor(n/2);c.push(s?1:0),c.reverse();const h=c.join("");let d="";for(i=0;i<64;i+=8){let e=parseInt(h.substr(i,8),2).toString(16);1===e.length&&(e="0"+e),d+=e}return d.toLowerCase()};const V=new RegExp("^-?(0*)\\d{1,10}$"),G=function(e){if(V.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},K=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw R("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Q=function(e,time){const t=setTimeout(e,time);return"number"==typeof t&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class Y{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){R(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class J{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(j("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',R(e)}}class X{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}X.OWNER="owner";const Z="5",ee=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,te="ac",ne="websocket",re="long_polling";class ie{constructor(e,t,n,r,o=!1,l="",c=!1,h=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=o,this.persistenceKey=l,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=w.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&w.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function se(e,t,n){let r;if(Object(l.f)("string"==typeof t,"typeof type must == string"),Object(l.f)("object"==typeof n,"typeof params must == object"),t===ne)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==re)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const o=[];return H(n,((e,t)=>{o.push(e+"="+t)})),r+o.join("&")}class oe{constructor(){this.counters_={}}incrementCounter(e,t=1){Object(l.l)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Object(l.o)(this.counters_)}}const ae={},le={};function ce(e){const t=e.toString();return ae[t]||(ae[t]=new oe),ae[t]}class he{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,data){for(this.pendingResponses[e]=data;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<e.length;++i)e[i]&&K((()=>{this.onMessage_(e[i])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ue="start";class de{constructor(e,t,n,r,o,l,c){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=o,this.transportSessionId=l,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(e),this.stats_=ce(t),this.urlFn=e=>(this.appCheckToken&&(e[te]=this.appCheckToken),se(t,re,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new he(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Object(l.H)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new pe(((...e)=>{const[t,n,r,o,l]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===ue)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,data]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,data)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[ue]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=Z,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[te]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&ee.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){de.forceAllow_=!0}static forceDisallow(){de.forceDisallow_=!0}static isAvailable(){return!Object(l.H)()&&(!!de.forceAllow_||!(de.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(data){const e=Object(l.R)(data);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const t=Object(l.j)(e),n=W(t,1840);for(let i=0;i<n.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Object(l.H)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Object(l.R)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class pe{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(l.H)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=S(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=pe.createIFrame_();let script="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){script='<script>document.domain="'+document.domain+'";<\/script>'}const n="<html><body>"+script+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(n),this.myIFrame.doc.close()}catch(e){j("frame writing exception"),e.stack&&j(e.stack),j(e)}}}static createIFrame_(){const iframe=document.createElement("iframe");if(iframe.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(iframe);try{iframe.contentWindow.document||j("No IE domain setting required")}catch(e){const t=document.domain;iframe.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return iframe.contentDocument?iframe.doc=iframe.contentDocument:iframe.contentWindow?iframe.doc=iframe.contentWindow.document:iframe.document&&(iframe.doc=iframe.document),iframe}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,data){this.pendingSegs.push({seg:e,ts:t,d:data}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){Object(l.H)()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{j("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let fe=null;"undefined"!=typeof MozWebSocket?fe=MozWebSocket:"undefined"!=typeof WebSocket&&(fe=WebSocket);class _e{constructor(e,t,n,r,o,l,c){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=ce(t),this.connURL=_e.connectionURL_(t,l,c,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,o){const c={};return c.v=Z,!Object(l.H)()&&"undefined"!=typeof location&&location.hostname&&ee.test(location.hostname)&&(c.r="f"),t&&(c.s=t),n&&(c.ls=n),r&&(c[te]=r),o&&(c.p=o),se(e,ne,c)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,w.set("previous_websocket_failure",!0);try{let t;if(Object(l.H)()){const n=this.nodeAdmin?"AdminNode":"Node";t={headers:{"User-Agent":`Firebase/${Z}/${f}/${e.platform}/${n}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(t.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(t.headers["X-Firebase-AppCheck"]=this.appCheckToken);const r=e.env,o=0===this.connURL.indexOf("wss://")?r.HTTPS_PROXY||r.https_proxy:r.HTTP_PROXY||r.http_proxy;o&&(t.proxy={origin:o})}this.mySock=new fe(this.connURL,[],t)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){_e.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==fe&&!_e.forceDisallow_}static previouslyFailed(){return w.isInMemoryStorage||!0===w.get("previous_websocket_failure")}markConnectionHealthy(){w.remove("previous_websocket_failure")}appendFrame_(data){if(this.frames.push(data),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Object(l.K)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(data){if(Object(l.f)(null===this.frames,"We already have a frame buffer"),data.length<=6){const e=Number(data);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),data}handleIncomingFrame(e){if(null===this.mySock)return;const data=e.data;if(this.bytesReceived+=data.length,this.stats_.incrementCounter("bytes_received",data.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(data);else{const e=this.extractFrameCount_(data);null!==e&&this.appendFrame_(e)}}send(data){this.resetKeepAlive();const e=Object(l.R)(data);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const t=W(e,16384);t.length>1&&this.sendString_(String(t.length));for(let i=0;i<t.length;i++)this.sendString_(t[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}_e.responsesRequiredToBeHealthy=2,_e.healthyTimeout=3e4;class ge{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[de,_e]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=_e&&_e.isAvailable();let n=t&&!_e.previouslyFailed();if(e.webSocketOnly&&(t||R("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[_e];else{const e=this.transports_=[];for(const t of ge.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ge.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ge.globalTransportInitialized_=!1;class me{constructor(e,t,n,r,o,l,c,h,d,f){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=o,this.onMessage_=l,this.onReady_=c,this.onDisconnect_=h,this.onKill_=d,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new ge(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Q((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=$("t",e),data=$("d",e);if("c"===t)this.onSecondaryControl_(data);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(data)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=$("t",e),data=$("d",e);"c"===t?this.onControl_(data):"d"===t&&this.onDataMessage_(data)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=$("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?D("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):D("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Z!==n&&R("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Q((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Q((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(w.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(data){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(data)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class be{put(e,data,t,n){}merge(e,data,t,n){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,data,t){}onDisconnectMerge(e,data,t){}onDisconnectCancel(e,t){}reportStats(e){}}class ve{constructor(e){this.allowedEvents_=e,this.listeners_={},Object(l.f)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(e){Object(l.f)(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class ye extends ve{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(l.F)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new ye}getInitialEvent(e){return Object(l.f)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const we=32,Oe=768;class Ce{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[t]=this.pieces_[i],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let i=this.pieceNum_;i<this.pieces_.length;i++)""!==this.pieces_[i]&&(e+="/"+this.pieces_[i]);return e||"/"}}function Se(){return new Ce("")}function xe(path){return path.pieceNum_>=path.pieces_.length?null:path.pieces_[path.pieceNum_]}function ke(path){return path.pieces_.length-path.pieceNum_}function Ie(path){let e=path.pieceNum_;return e<path.pieces_.length&&e++,new Ce(path.pieces_,e)}function Pe(path){return path.pieceNum_<path.pieces_.length?path.pieces_[path.pieces_.length-1]:null}function Te(path,e=0){return path.pieces_.slice(path.pieceNum_+e)}function je(path){if(path.pieceNum_>=path.pieces_.length)return null;const e=[];for(let i=path.pieceNum_;i<path.pieces_.length-1;i++)e.push(path.pieces_[i]);return new Ce(e,0)}function Ee(path,e){const t=[];for(let i=path.pieceNum_;i<path.pieces_.length;i++)t.push(path.pieces_[i]);if(e instanceof Ce)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const n=e.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&t.push(n[i])}return new Ce(t,0)}function De(path){return path.pieceNum_>=path.pieces_.length}function Ne(e,t){const n=xe(e),r=xe(t);if(null===n)return t;if(n===r)return Ne(Ie(e),Ie(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Re(e,t){const n=Te(e,0),r=Te(t,0);for(let i=0;i<n.length&&i<r.length;i++){const e=U(n[i],r[i]);if(0!==e)return e}return n.length===r.length?0:n.length<r.length?-1:1}function Me(path,e){if(ke(path)!==ke(e))return!1;for(let i=path.pieceNum_,t=e.pieceNum_;i<=path.pieces_.length;i++,t++)if(path.pieces_[i]!==e.pieces_[t])return!1;return!0}function Ae(path,e){let i=path.pieceNum_,t=e.pieceNum_;if(ke(path)>ke(e))return!1;for(;i<path.pieces_.length;){if(path.pieces_[i]!==e.pieces_[t])return!1;++i,++t}return!0}class Fe{constructor(path,e){this.errorPrefix_=e,this.parts_=Te(path,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Object(l.P)(this.parts_[i]);Ue(this)}}function Ue(e){if(e.byteLength_>Oe)throw new Error(e.errorPrefix_+"has a key path longer than "+Oe+" bytes ("+e.byteLength_+").");if(e.parts_.length>we)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+we+") or object contains a cycle "+Le(e))}function Le(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class $e extends ve{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new $e}getInitialEvent(e){return Object(l.f)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const qe=1e3;class Be extends be{constructor(e,t,n,r,o,c,h,d){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=Be.nextPersistentConnectionId_++,this.log_=E("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=qe,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d&&!Object(l.H)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$e.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&ye.getInstance().on("online",this.onOnline_,this)}sendRequest(e,body,t){const n=++this.requestNumber_,r={r:n,a:e,b:body};this.log_(Object(l.R)(r)),Object(l.f)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),t&&(this.requestCBHash_[n]=t)}get(e){this.initConnection_();const t=new l.a,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const o=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),Object(l.f)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(l.f)(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const h={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(c).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const o={p:n};e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(o=>{const l=o.d,c=o.s;Be.warnOnListenWarnings_(l,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",o),"ok"!==c&&this.removeListen_(n,r),e.onComplete&&e.onComplete(c,l))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&Object(l.l)(e,"w")){const n=Object(l.O)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();R(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||Object(l.z)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Object(l.J)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,data=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,data))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,data=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,data)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(l.f)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const o={p:e};r&&(o.q=n,o.t=r),this.sendRequest("n",o)}onDisconnectPut(e,data,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,data,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:data,onComplete:t})}onDisconnectMerge(e,data,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,data,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:data,onComplete:t})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,data,n){const r={p:t,d:data};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{n&&setTimeout((()=>{n(e.s,e.d)}),Math.floor(0))}))}put(e,data,t,n){this.putInternal("p",e,data,t,n)}merge(e,data,t,n){this.putInternal("m",e,data,t,n)}putInternal(e,t,data,n,r){this.initConnection_();const o={p:t,d:data};void 0!==r&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:n}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Object(l.R)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,body){this.log_("handleServerMessage",e,body),"d"===e?this.onDataUpdate_(body.p,body.d,!1,body.t):"m"===e?this.onDataUpdate_(body.p,body.d,!0,body.t):"c"===e?this.onListenRevoked_(body.p,body.q):"ac"===e?this.onAuthRevoked_(body.s,body.d):"apc"===e?this.onAppCheckRevoked_(body.s,body.d):"sd"===e?this.onSecurityDebugPacket_(body):D("Unrecognized action received from server: "+Object(l.R)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Object(l.f)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=qe,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=qe,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=qe),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Be.nextConnectionId_++,o=this.lastSessionId;let c=!1,h=null;const d=function(){h?h.close():(c=!0,n())},f=function(e){Object(l.f)(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(e)};this.realtime_={close:d,sendRequest:f};const _=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[l,d]=await Promise.all([this.authTokenProvider_.getToken(_),this.appCheckTokenProvider_.getToken(_)]);c?j("getToken() completed but was canceled"):(j("getToken() completed. Creating connection."),this.authToken_=l&&l.accessToken,this.appCheckToken_=d&&d.token,h=new me(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{R(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),o))}catch(e){this.log_("Failed to get token: "+e),c||(this.repoInfo_.nodeAdmin&&R(e),d())}}}interrupt(e){j("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){j("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(l.C)(this.interruptReasons_)&&(this.reconnectDelay_=qe,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let i=0;i<this.outstandingPuts_.length;i++){const e=this.outstandingPuts_[i];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((q=>B(q))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Ce(e).toString();let r;if(this.listens.has(n)){const map=this.listens.get(n);r=map.get(t),map.delete(t),0===map.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){j("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){j("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(body){this.securityDebugCallback_?this.securityDebugCallback_(body):"msg"in body&&console.log("FIREBASE: "+body.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let i=0;i<this.outstandingGets_.length;i++)this.outstandingGets_[i]&&this.sendGet_(i)}sendConnectStats_(){const e={};let t="js";Object(l.H)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+f.replace(/\./g,"-")]=1,Object(l.F)()?e["framework.cordova"]=1:Object(l.I)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ye.getInstance().currentlyOnline();return Object(l.C)(this.interruptReasons_)&&e}}Be.nextPersistentConnectionId_=0,Be.nextConnectionId_=0;class We{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new We(e,t)}}class He{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new We(A,e),r=new We(A,t);return 0!==this.compare(n,r)}minPost(){return We.MIN}}let ze;class Ve extends He{static get __EMPTY_NODE(){return ze}static set __EMPTY_NODE(e){ze=e}compare(a,b){return U(a.name,b.name)}isDefinedOn(e){throw Object(l.g)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return We.MIN}maxPost(){return new We(F,ze)}makePost(e,t){return Object(l.f)("string"==typeof e,"KeyIndex indexValue must always be a string."),new We(e,ze)}toString(){return".key"}}const Ge=new Ve;class Ke{constructor(e,t,n,r,o=null){this.isReverse_=r,this.resultGenerator_=o,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?n(e.key,t):1,r&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Qe{constructor(e,t,n,r,o){this.key=e,this.value=t,this.color=null!=n?n:Qe.RED,this.left=null!=r?r:Ye.EMPTY_NODE,this.right=null!=o?o:Ye.EMPTY_NODE}copy(e,t,n,r,o){return new Qe(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=o?o:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const o=n(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===o?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ye.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Ye.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Qe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Qe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Qe.RED=!0,Qe.BLACK=!1;class Ye{constructor(e,t=Ye.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Ye(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Qe.BLACK,null,null))}remove(e){return new Ye(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Qe.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ke(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ke(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ke(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ke(this.root_,null,this.comparator_,!0,e)}}function Je(e,t){return U(e.name,t.name)}function Xe(e,t){return U(e,t)}let Ze;Ye.EMPTY_NODE=new class{copy(e,t,n,r,o){return this}insert(e,t,n){return new Qe(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const et=function(e){return"number"==typeof e?"number:"+z(e):"string:"+e},tt=function(e){if(e.isLeafNode()){const t=e.val();Object(l.f)("string"==typeof t||"number"==typeof t||"object"==typeof t&&Object(l.l)(t,".sv"),"Priority must be a string or number.")}else Object(l.f)(e===Ze||e.isEmpty(),"priority of unexpected type.");Object(l.f)(e===Ze||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let nt,it,st;class ot{constructor(e,t=ot.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Object(l.f)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),tt(this.priorityNode_)}static set __childrenNodeConstructor(e){nt=e}static get __childrenNodeConstructor(){return nt}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ot(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:ot.__childrenNodeConstructor.EMPTY_NODE}getChild(path){return De(path)?this:".priority"===xe(path)?this.priorityNode_:ot.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:ot.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(path,e){const t=xe(path);return null===t?e:e.isEmpty()&&".priority"!==t?this:(Object(l.f)(".priority"!==t||1===ke(path),".priority must be the last token in a path"),this.updateImmediateChild(t,ot.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ie(path),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+et(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?z(this.value_):this.value_,this.lazyHash_=x(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ot.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ot.__childrenNodeConstructor?-1:(Object(l.f)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=ot.VALUE_TYPE_ORDER.indexOf(t),o=ot.VALUE_TYPE_ORDER.indexOf(n);return Object(l.f)(r>=0,"Unknown leaf type: "+t),Object(l.f)(o>=0,"Unknown leaf type: "+n),r===o?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}ot.VALUE_TYPE_ORDER=["object","boolean","number","string"];const at=new class extends He{compare(a,b){const e=a.node.getPriority(),t=b.node.getPriority(),n=e.compareTo(t);return 0===n?U(a.name,b.name):n}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return We.MIN}maxPost(){return new We(F,new ot("[PRIORITY-POST]",st))}makePost(e,t){const n=it(e);return new We(t,new ot("[PRIORITY-POST]",n))}toString(){return".priority"}},lt=Math.log(2);class ct{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/lt,10)),this.current_=this.count-1;const mask=(n=this.count,parseInt(Array(n+1).join("1"),2));var n;this.bits_=e+1&mask}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ht=function(e,t,n,r){e.sort(t);const o=function(t,r){const l=r-t;let c,h;if(0===l)return null;if(1===l)return c=e[t],h=n?n(c):c,new Qe(h,c.node,Qe.BLACK,null,null);{const d=parseInt(l/2,10)+t,f=o(t,d),_=o(d+1,r);return c=e[d],h=n?n(c):c,new Qe(h,c.node,Qe.BLACK,f,_)}},l=function(t){let r=null,l=null,c=e.length;const h=function(t,r){const l=c-t,h=c;c-=t;const f=o(l+1,h),_=e[l],m=n?n(_):_;d(new Qe(m,_.node,r,null,f))},d=function(e){r?(r.left=e,r=e):(l=e,r=e)};for(let i=0;i<t.count;++i){const e=t.nextBitIsOne(),n=Math.pow(2,t.count-(i+1));e?h(n,Qe.BLACK):(h(n,Qe.BLACK),h(n,Qe.RED))}return l}(new ct(e.length));return new Ye(r||t,l)};let ut;const pt={};class ft{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Object(l.f)(pt&&at,"ChildrenNode.ts has not been loaded"),ut=ut||new ft({".priority":pt},{".priority":at}),ut}get(e){const t=Object(l.O)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ye?t:null}hasIndex(e){return Object(l.l)(this.indexSet_,e.toString())}addIndex(e,t){Object(l.f)(e!==Ge,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const o=t.getIterator(We.Wrap);let c,h=o.getNext();for(;h;)r=r||e.isDefinedOn(h.node),n.push(h),h=o.getNext();c=r?ht(n,e.getCompare()):pt;const d=e.toString(),f=Object.assign({},this.indexSet_);f[d]=e;const _=Object.assign({},this.indexes_);return _[d]=c,new ft(_,f)}addToIndexes(e,t){const n=Object(l.L)(this.indexes_,((n,r)=>{const o=Object(l.O)(this.indexSet_,r);if(Object(l.f)(o,"Missing index implementation for "+r),n===pt){if(o.isDefinedOn(e.node)){const n=[],r=t.getIterator(We.Wrap);let l=r.getNext();for(;l;)l.name!==e.name&&n.push(l),l=r.getNext();return n.push(e),ht(n,o.getCompare())}return pt}{const r=t.get(e.name);let o=n;return r&&(o=o.remove(new We(e.name,r))),o.insert(e,e.node)}}));return new ft(n,this.indexSet_)}removeFromIndexes(e,t){const n=Object(l.L)(this.indexes_,(n=>{if(n===pt)return n;{const r=t.get(e.name);return r?n.remove(new We(e.name,r)):n}}));return new ft(n,this.indexSet_)}}let _t;class gt{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&tt(this.priorityNode_),this.children_.isEmpty()&&Object(l.f)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return _t||(_t=new gt(new Ye(Xe),null,ft.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||_t}updatePriority(e){return this.children_.isEmpty()?this:new gt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?_t:t}}getChild(path){const e=xe(path);return null===e?this:this.getImmediateChild(e).getChild(Ie(path))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Object(l.f)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new We(e,t);let r,o;t.isEmpty()?(r=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(n,this.children_));const l=r.isEmpty()?_t:this.priorityNode_;return new gt(r,l,o)}}updateChild(path,e){const t=xe(path);if(null===t)return e;{Object(l.f)(".priority"!==xe(path)||1===ke(path),".priority must be the last token in a path");const n=this.getImmediateChild(t).updateChild(Ie(path),e);return this.updateImmediateChild(t,n)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,o=!0;if(this.forEachChild(at,((l,c)=>{t[l]=c.val(e),n++,o&&gt.INTEGER_REGEXP_.test(l)?r=Math.max(r,Number(l)):o=!1})),!e&&o&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+et(this.getPriority().val())+":"),this.forEachChild(at,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":x(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new We(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new We(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new We(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,We.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,We.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===mt?-1:0}withIndex(e){if(e===Ge||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new gt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ge||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(at),n=t.getIterator(at);let r=e.getNext(),o=n.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=e.getNext(),o=n.getNext()}return null===r&&null===o}return!1}return!1}}resolveIndex_(e){return e===Ge?null:this.indexMap_.get(e.toString())}}gt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const mt=new class extends gt{constructor(){super(new Ye(Xe),gt.EMPTY_NODE,ft.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return gt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(We,{MIN:{value:new We(A,gt.EMPTY_NODE)},MAX:{value:new We(F,mt)}}),Ve.__EMPTY_NODE=gt.EMPTY_NODE,ot.__childrenNodeConstructor=gt,Ze=mt,function(e){st=e}(mt);const bt=!0;function vt(e,t=null){if(null===e)return gt.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Object(l.f)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new ot(e,vt(t))}if(e instanceof Array||!bt){let n=gt.EMPTY_NODE;return H(e,((t,r)=>{if(Object(l.l)(e,t)&&"."!==t.substring(0,1)){const e=vt(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(vt(t))}{const n=[];let r=!1;if(H(e,((e,t)=>{if("."!==e.substring(0,1)){const o=vt(t);o.isEmpty()||(r=r||!o.getPriority().isEmpty(),n.push(new We(e,o)))}})),0===n.length)return gt.EMPTY_NODE;const o=ht(n,Je,(e=>e.name),Xe);if(r){const e=ht(n,at.getCompare());return new gt(o,vt(t),new ft({".priority":e},{".priority":at}))}return new gt(o,vt(t),ft.Default)}}!function(e){it=e}(vt);class yt extends He{constructor(e){super(),this.indexPath_=e,Object(l.f)(!De(e)&&".priority"!==xe(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(a,b){const e=this.extractChild(a.node),t=this.extractChild(b.node),n=e.compareTo(t);return 0===n?U(a.name,b.name):n}makePost(e,t){const n=vt(e),r=gt.EMPTY_NODE.updateChild(this.indexPath_,n);return new We(t,r)}maxPost(){const e=gt.EMPTY_NODE.updateChild(this.indexPath_,mt);return new We(F,e)}toString(){return Te(this.indexPath_,0).join("/")}}const wt=new class extends He{compare(a,b){const e=a.node.compareTo(b.node);return 0===e?U(a.name,b.name):e}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return We.MIN}maxPost(){return We.MAX}makePost(e,t){const n=vt(e);return new We(t,n)}toString(){return".value"}};function Ot(e){return{type:"value",snapshotNode:e}}function Ct(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function St(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function xt(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class kt{constructor(e){this.index_=e}updateChild(e,t,n,r,source,o){Object(l.f)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const c=e.getImmediateChild(t);return c.getChild(r).equals(n.getChild(r))&&c.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(St(t,c)):Object(l.f)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?o.trackChildChange(Ct(t,n)):o.trackChildChange(xt(t,n,c))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(at,((e,r)=>{t.hasChild(e)||n.trackChildChange(St(e,r))})),t.isLeafNode()||t.forEachChild(at,((t,r)=>{if(e.hasChild(t)){const o=e.getImmediateChild(t);o.equals(r)||n.trackChildChange(xt(t,r,o))}else n.trackChildChange(Ct(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?gt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class It{constructor(e){this.indexedFilter_=new kt(e.getIndex()),this.index_=e.getIndex(),this.startPost_=It.getStartPost_(e),this.endPost_=It.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,source,o){return this.matches(new We(t,n))||(n=gt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,source,o)}updateFullNode(e,t,n){t.isLeafNode()&&(t=gt.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(gt.EMPTY_NODE);const o=this;return t.forEachChild(at,((e,t)=>{o.matches(new We(e,t))||(r=r.updateImmediateChild(e,gt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Pt{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new It(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,source,o){return this.rangedFilter_.matches(new We(t,n))||(n=gt.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,source,o):this.fullLimitUpdateChild_(e,t,n,source,o)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=gt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=gt.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(gt.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,gt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,source,r){let o;if(this.reverse_){const e=this.index_.getCompare();o=(a,b)=>e(b,a)}else o=this.index_.getCompare();const c=e;Object(l.f)(c.numChildren()===this.limit_,"");const h=new We(t,n),d=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),f=this.rangedFilter_.matches(h);if(c.hasChild(t)){const e=c.getImmediateChild(t);let l=source.getChildAfterChild(this.index_,d,this.reverse_);for(;null!=l&&(l.name===t||c.hasChild(l.name));)l=source.getChildAfterChild(this.index_,l,this.reverse_);const _=null==l?1:o(l,h);if(f&&!n.isEmpty()&&_>=0)return null!=r&&r.trackChildChange(xt(t,n,e)),c.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(St(t,e));const n=c.updateImmediateChild(t,gt.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=r&&r.trackChildChange(Ct(l.name,l.node)),n.updateImmediateChild(l.name,l.node)):n}}return n.isEmpty()?e:f&&o(d,h)>=0?(null!=r&&(r.trackChildChange(St(d.name,d.node)),r.trackChildChange(Ct(t,n))),c.updateImmediateChild(t,n).updateImmediateChild(d.name,gt.EMPTY_NODE)):e}}class Tt{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=at}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Object(l.f)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Object(l.f)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A}hasEnd(){return this.endSet_}getIndexEndValue(){return Object(l.f)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Object(l.f)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:F}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Object(l.f)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===at}copy(){const e=new Tt;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function jt(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Et(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Dt(e,t){const n=e.copy();return n.index_=t,n}function Nt(e){const t={};if(e.isDefault())return t;let n;if(e.index_===at?n="$priority":e.index_===wt?n="$value":e.index_===Ge?n="$key":(Object(l.f)(e.index_ instanceof yt,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Object(l.R)(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=Object(l.R)(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+Object(l.R)(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=Object(l.R)(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+Object(l.R)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Rt(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==at&&(t.i=e.index_.toString()),t}class Mt extends be{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=E("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Object(l.f)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const c=Mt.getListenId_(e,n),h={};this.listens_[c]=h;const d=Nt(e._queryParams);this.restRequest_(o+".json",d,((e,t)=>{let data=t;if(404===e&&(data=null,e=null),null===e&&this.onDataUpdate_(o,data,!1,n),Object(l.O)(this.listens_,c)===h){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Mt.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Nt(e._queryParams),n=e._path.toString(),r=new l.a;return this.restRequest_(n+".json",t,((e,t)=>{let data=t;404===e&&(data=null,e=null),null===e?(this.onDataUpdate_(n,data,!1,null),r.resolve(data)):r.reject(new Error(data))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,o])=>{r&&r.accessToken&&(t.auth=r.accessToken),o&&o.token&&(t.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Object(l.M)(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(n&&4===h.readyState){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let e=null;if(h.status>=200&&h.status<300){try{e=Object(l.K)(h.responseText)}catch(e){R("Failed to parse JSON response for "+c+": "+h.responseText)}n(null,e)}else 401!==h.status&&404!==h.status&&R("Got unsuccessful REST response for "+c+" Status: "+h.status),n(h.status);n=null}},h.open("GET",c,!0),h.send()}))}}class At{constructor(){this.rootNode_=gt.EMPTY_NODE}getNode(path){return this.rootNode_.getChild(path)}updateSnapshot(path,e){this.rootNode_=this.rootNode_.updateChild(path,e)}}function Ft(){return{value:null,children:new Map}}function Ut(e,path,data){if(De(path))e.value=data,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(path,data);else{const t=xe(path);e.children.has(t)||e.children.set(t,Ft());Ut(e.children.get(t),path=Ie(path),data)}}function Lt(e,path){if(De(path))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const t=e.value;return e.value=null,t.forEachChild(at,((t,n)=>{Ut(e,new Ce(t),n)})),Lt(e,path)}}if(e.children.size>0){const t=xe(path);if(path=Ie(path),e.children.has(t)){Lt(e.children.get(t),path)&&e.children.delete(t)}return 0===e.children.size}return!0}function $t(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{$t(r,new Ce(t.toString()+"/"+e),n)}))}class qt{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&H(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Bt{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new qt(e);const n=1e4+2e4*Math.random();Q(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;H(e,((e,r)=>{r>0&&Object(l.l)(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),Q(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Wt;function Ht(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Wt||(Wt={}));class zt{constructor(path,e,t){this.path=path,this.affectedTree=e,this.revert=t,this.type=Wt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(De(this.path)){if(null!=this.affectedTree.value)return Object(l.f)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Ce(e));return new zt(Se(),t,this.revert)}}return Object(l.f)(xe(this.path)===e,"operationForChild called for unrelated child."),new zt(Ie(this.path),this.affectedTree,this.revert)}}class Vt{constructor(source,path){this.source=source,this.path=path,this.type=Wt.LISTEN_COMPLETE}operationForChild(e){return De(this.path)?new Vt(this.source,Se()):new Vt(this.source,Ie(this.path))}}class Gt{constructor(source,path,e){this.source=source,this.path=path,this.snap=e,this.type=Wt.OVERWRITE}operationForChild(e){return De(this.path)?new Gt(this.source,Se(),this.snap.getImmediateChild(e)):new Gt(this.source,Ie(this.path),this.snap)}}class Kt{constructor(source,path,e){this.source=source,this.path=path,this.children=e,this.type=Wt.MERGE}operationForChild(e){if(De(this.path)){const t=this.children.subtree(new Ce(e));return t.isEmpty()?null:t.value?new Gt(this.source,Se(),t.value):new Kt(this.source,Se(),t)}return Object(l.f)(xe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Kt(this.source,Ie(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Qt{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(path){if(De(path))return this.isFullyInitialized()&&!this.filtered_;const e=xe(path);return this.isCompleteForChild(e)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Yt{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Jt(e,t,n,r,o,c){const h=r.filter((e=>e.type===n));h.sort(((a,b)=>function(e,a,b){if(null==a.childName||null==b.childName)throw Object(l.g)("Should only compare child_ events.");const t=new We(a.childName,a.snapshotNode),n=new We(b.childName,b.snapshotNode);return e.index_.compare(t,n)}(e,a,b))),h.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,c);o.forEach((o=>{o.respondsTo(n.type)&&t.push(o.createEvent(r,e.query_))}))}))}function Xt(e,t){return{eventCache:e,serverCache:t}}function Zt(e,t,n,r){return Xt(new Qt(t,n,r),e.serverCache)}function en(e,t,n,r){return Xt(e.eventCache,new Qt(t,n,r))}function tn(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function nn(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let rn;class sn{constructor(e,t=(()=>(rn||(rn=new Ye(L)),rn))()){this.value=e,this.children=t}static fromObject(e){let t=new sn(null);return H(e,((e,n)=>{t=t.set(new Ce(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Se(),value:this.value};if(De(e))return null;{const n=xe(e),r=this.children.get(n);if(null!==r){const o=r.findRootMostMatchingPathAndValue(Ie(e),t);if(null!=o){return{path:Ee(new Ce(n),o.path),value:o.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(De(e))return this;{const t=xe(e),n=this.children.get(t);return null!==n?n.subtree(Ie(e)):new sn(null)}}set(e,t){if(De(e))return new sn(t,this.children);{const n=xe(e),r=(this.children.get(n)||new sn(null)).set(Ie(e),t),o=this.children.insert(n,r);return new sn(this.value,o)}}remove(e){if(De(e))return this.children.isEmpty()?new sn(null):new sn(null,this.children);{const t=xe(e),n=this.children.get(t);if(n){const r=n.remove(Ie(e));let o;return o=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&o.isEmpty()?new sn(null):new sn(this.value,o)}return this}}get(e){if(De(e))return this.value;{const t=xe(e),n=this.children.get(t);return n?n.get(Ie(e)):null}}setTree(e,t){if(De(e))return t;{const n=xe(e),r=(this.children.get(n)||new sn(null)).setTree(Ie(e),t);let o;return o=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new sn(this.value,o)}}fold(e){return this.fold_(Se(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,o)=>{n[r]=o.fold_(Ee(e,r),t)})),t(e,this.value,n)}findOnPath(path,e){return this.findOnPath_(path,Se(),e)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(De(e))return null;{const r=xe(e),o=this.children.get(r);return o?o.findOnPath_(Ie(e),Ee(t,r),n):null}}foreachOnPath(path,e){return this.foreachOnPath_(path,Se(),e)}foreachOnPath_(e,t,n){if(De(e))return this;{this.value&&n(t,this.value);const r=xe(e),o=this.children.get(r);return o?o.foreachOnPath_(Ie(e),Ee(t,r),n):new sn(null)}}foreach(e){this.foreach_(Se(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Ee(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class on{constructor(e){this.writeTree_=e}static empty(){return new on(new sn(null))}}function an(e,path,t){if(De(path))return new on(new sn(t));{const n=e.writeTree_.findRootMostValueAndPath(path);if(null!=n){const r=n.path;let o=n.value;const l=Ne(r,path);return o=o.updateChild(l,t),new on(e.writeTree_.set(r,o))}{const n=new sn(t),r=e.writeTree_.setTree(path,n);return new on(r)}}}function ln(e,path,t){let n=e;return H(t,((e,t)=>{n=an(n,Ee(path,e),t)})),n}function cn(e,path){if(De(path))return on.empty();{const t=e.writeTree_.setTree(path,new sn(null));return new on(t)}}function hn(e,path){return null!=un(e,path)}function un(e,path){const t=e.writeTree_.findRootMostValueAndPath(path);return null!=t?e.writeTree_.get(t.path).getChild(Ne(t.path,path)):null}function dn(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(at,((e,n)=>{t.push(new We(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new We(e,n.value))})),t}function pn(e,path){if(De(path))return e;{const t=un(e,path);return new on(null!=t?new sn(t):e.writeTree_.subtree(path))}}function fn(e){return e.writeTree_.isEmpty()}function _n(e,t){return gn(Se(),e.writeTree_,t)}function gn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,o)=>{".priority"===t?(Object(l.f)(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):n=gn(Ee(e,t),o,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Ee(e,".priority"),r)),n}}function mn(e,path){return jn(path,e)}function bn(e,t){const n=e.allWrites.findIndex((s=>s.writeId===t));Object(l.f)(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let o=r.visible,c=!1,i=e.allWrites.length-1;for(;o&&i>=0;){const t=e.allWrites[i];t.visible&&(i>=n&&vn(t,r.path)?o=!1:Ae(r.path,t.path)&&(c=!0)),i--}if(o){if(c)return function(e){e.visibleWrites=wn(e.allWrites,yn,Se()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=cn(e.visibleWrites,r.path);else{H(r.children,(t=>{e.visibleWrites=cn(e.visibleWrites,Ee(r.path,t))}))}return!0}return!1}function vn(e,path){if(e.snap)return Ae(e.path,path);for(const t in e.children)if(e.children.hasOwnProperty(t)&&Ae(Ee(e.path,t),path))return!0;return!1}function yn(e){return e.visible}function wn(e,filter,t){let n=on.empty();for(let i=0;i<e.length;++i){const r=e[i];if(filter(r)){const e=r.path;let o;if(r.snap)Ae(t,e)?(o=Ne(t,e),n=an(n,o,r.snap)):Ae(e,t)&&(o=Ne(e,t),n=an(n,Se(),r.snap.getChild(o)));else{if(!r.children)throw Object(l.g)("WriteRecord should have .snap or .children");if(Ae(t,e))o=Ne(t,e),n=ln(n,o,r.children);else if(Ae(e,t))if(o=Ne(e,t),De(o))n=ln(n,Se(),r.children);else{const e=Object(l.O)(r.children,xe(o));if(e){const t=e.getChild(Ie(o));n=an(n,Se(),t)}}}}}return n}function On(e,t,n,r,o){if(r||o){const l=pn(e.visibleWrites,t);if(!o&&fn(l))return n;if(o||null!=n||hn(l,Se())){const filter=function(e){return(e.visible||o)&&(!r||!~r.indexOf(e.writeId))&&(Ae(e.path,t)||Ae(t,e.path))};return _n(wn(e.allWrites,filter,t),n||gt.EMPTY_NODE)}return null}{const r=un(e.visibleWrites,t);if(null!=r)return r;{const r=pn(e.visibleWrites,t);if(fn(r))return n;if(null!=n||hn(r,Se())){return _n(r,n||gt.EMPTY_NODE)}return null}}}function Cn(e,t,n,r){return On(e.writeTree,e.treePath,t,n,r)}function Sn(e,t){return function(e,t,n){let r=gt.EMPTY_NODE;const o=un(e.visibleWrites,t);if(o)return o.isLeafNode()||o.forEachChild(at,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const o=pn(e.visibleWrites,t);return n.forEachChild(at,((e,t)=>{const n=_n(pn(o,new Ce(e)),t);r=r.updateImmediateChild(e,n)})),dn(o).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return dn(pn(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function xn(e,path,t,n){return function(e,t,n,r,o){Object(l.f)(r||o,"Either existingEventSnap or existingServerSnap must exist");const path=Ee(t,n);if(hn(e.visibleWrites,path))return null;{const t=pn(e.visibleWrites,path);return fn(t)?o.getChild(n):_n(t,o.getChild(n))}}(e.writeTree,e.treePath,path,t,n)}function kn(e,path){return function(e,path){return un(e.visibleWrites,path)}(e.writeTree,Ee(e.treePath,path))}function In(e,t,n,r,o,l){return function(e,t,n,r,o,l,c){let h;const d=pn(e.visibleWrites,t),f=un(d,Se());if(null!=f)h=f;else{if(null==n)return[];h=_n(d,n)}if(h=h.withIndex(c),h.isEmpty()||h.isLeafNode())return[];{const e=[],t=c.getCompare(),n=l?h.getReverseIteratorFrom(r,c):h.getIteratorFrom(r,c);let d=n.getNext();for(;d&&e.length<o;)0!==t(d,r)&&e.push(d),d=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,o,l)}function Pn(e,t,n){return function(e,t,n,r){const path=Ee(t,n),o=un(e.visibleWrites,path);if(null!=o)return o;if(r.isCompleteForChild(n))return _n(pn(e.visibleWrites,path),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function Tn(e,t){return jn(Ee(e.treePath,t),e.writeTree)}function jn(path,e){return{treePath:path,writeTree:e}}class En{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Object(l.f)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Object(l.f)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const o=r.type;if("child_added"===t&&"child_removed"===o)this.changeMap.set(n,xt(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===o)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===o)this.changeMap.set(n,St(n,r.oldSnap));else if("child_changed"===t&&"child_added"===o)this.changeMap.set(n,Ct(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==o)throw Object(l.g)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,xt(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Dn=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Nn{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Qt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Pn(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:nn(this.viewCache_),o=In(this.writes_,r,t,1,n,e);return 0===o.length?null:o[0]}}function Rn(e,t,n,r,o){const c=new En;let h,d;if(n.type===Wt.OVERWRITE){const f=n;f.source.fromUser?h=Fn(e,t,f.path,f.snap,r,o,c):(Object(l.f)(f.source.fromServer,"Unknown source."),d=f.source.tagged||t.serverCache.isFiltered()&&!De(f.path),h=An(e,t,f.path,f.snap,r,o,d,c))}else if(n.type===Wt.MERGE){const f=n;f.source.fromUser?h=function(e,t,path,n,r,o,l){let c=t;return n.foreach(((n,h)=>{const d=Ee(path,n);Un(t,xe(d))&&(c=Fn(e,c,d,h,r,o,l))})),n.foreach(((n,h)=>{const d=Ee(path,n);Un(t,xe(d))||(c=Fn(e,c,d,h,r,o,l))})),c}(e,t,f.path,f.children,r,o,c):(Object(l.f)(f.source.fromServer,"Unknown source."),d=f.source.tagged||t.serverCache.isFiltered(),h=$n(e,t,f.path,f.children,r,o,d,c))}else if(n.type===Wt.ACK_USER_WRITE){const d=n;h=d.revert?function(e,t,path,n,r,o){let c;if(null!=kn(n,path))return t;{const source=new Nn(n,t,r),h=t.eventCache.getNode();let d;if(De(path)||".priority"===xe(path)){let r;if(t.serverCache.isFullyInitialized())r=Cn(n,nn(t));else{const e=t.serverCache.getNode();Object(l.f)(e instanceof gt,"serverChildren would be complete if leaf node"),r=Sn(n,e)}d=e.filter.updateFullNode(h,r,o)}else{const r=xe(path);let l=Pn(n,r,t.serverCache);null==l&&t.serverCache.isCompleteForChild(r)&&(l=h.getImmediateChild(r)),d=null!=l?e.filter.updateChild(h,r,l,Ie(path),source,o):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(h,r,gt.EMPTY_NODE,Ie(path),source,o):h,d.isEmpty()&&t.serverCache.isFullyInitialized()&&(c=Cn(n,nn(t)),c.isLeafNode()&&(d=e.filter.updateFullNode(d,c,o)))}return c=t.serverCache.isFullyInitialized()||null!=kn(n,Se()),Zt(t,d,c,e.filter.filtersNodes())}}(e,t,d.path,r,o,c):function(e,t,n,r,o,l,c){if(null!=kn(o,n))return t;const h=t.serverCache.isFiltered(),d=t.serverCache;if(null!=r.value){if(De(n)&&d.isFullyInitialized()||d.isCompleteForPath(n))return An(e,t,n,d.getNode().getChild(n),o,l,h,c);if(De(n)){let r=new sn(null);return d.getNode().forEachChild(Ge,((e,t)=>{r=r.set(new Ce(e),t)})),$n(e,t,n,r,o,l,h,c)}return t}{let f=new sn(null);return r.foreach(((e,t)=>{const r=Ee(n,e);d.isCompleteForPath(r)&&(f=f.set(e,d.getNode().getChild(r)))})),$n(e,t,n,f,o,l,h,c)}}(e,t,d.path,d.affectedTree,r,o,c)}else{if(n.type!==Wt.LISTEN_COMPLETE)throw Object(l.g)("Unknown operation type: "+n.type);h=function(e,t,path,n,r){const o=t.serverCache,l=en(t,o.getNode(),o.isFullyInitialized()||De(path),o.isFiltered());return Mn(e,l,path,n,Dn,r)}(e,t,n.path,r,c)}const f=c.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const o=r.getNode().isLeafNode()||r.getNode().isEmpty(),l=tn(e);(n.length>0||!e.eventCache.isFullyInitialized()||o&&!r.getNode().equals(l)||!r.getNode().getPriority().equals(l.getPriority()))&&n.push(Ot(tn(t)))}}(t,h,f),{viewCache:h,changes:f}}function Mn(e,t,n,r,source,o){const c=t.eventCache;if(null!=kn(r,n))return t;{let h,d;if(De(n))if(Object(l.f)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=nn(t),l=Sn(r,n instanceof gt?n:gt.EMPTY_NODE);h=e.filter.updateFullNode(t.eventCache.getNode(),l,o)}else{const n=Cn(r,nn(t));h=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const f=xe(n);if(".priority"===f){Object(l.f)(1===ke(n),"Can't have a priority with additional path components");const o=c.getNode();d=t.serverCache.getNode();const f=xn(r,n,o,d);h=null!=f?e.filter.updatePriority(o,f):c.getNode()}else{const l=Ie(n);let _;if(c.isCompleteForChild(f)){d=t.serverCache.getNode();const e=xn(r,n,c.getNode(),d);_=null!=e?c.getNode().getImmediateChild(f).updateChild(l,e):c.getNode().getImmediateChild(f)}else _=Pn(r,f,t.serverCache);h=null!=_?e.filter.updateChild(c.getNode(),f,_,l,source,o):c.getNode()}}return Zt(t,h,c.isFullyInitialized()||De(n),e.filter.filtersNodes())}}function An(e,t,n,r,o,l,c,h){const d=t.serverCache;let f;const _=c?e.filter:e.filter.getIndexedFilter();if(De(n))f=_.updateFullNode(d.getNode(),r,null);else if(_.filtersNodes()&&!d.isFiltered()){const e=d.getNode().updateChild(n,r);f=_.updateFullNode(d.getNode(),e,null)}else{const e=xe(n);if(!d.isCompleteForPath(n)&&ke(n)>1)return t;const o=Ie(n),l=d.getNode().getImmediateChild(e).updateChild(o,r);f=".priority"===e?_.updatePriority(d.getNode(),l):_.updateChild(d.getNode(),e,l,o,Dn,null)}const m=en(t,f,d.isFullyInitialized()||De(n),_.filtersNodes());return Mn(e,m,n,o,new Nn(o,m,l),h)}function Fn(e,t,n,r,o,l,c){const h=t.eventCache;let d,f;const source=new Nn(o,t,l);if(De(n))f=e.filter.updateFullNode(t.eventCache.getNode(),r,c),d=Zt(t,f,!0,e.filter.filtersNodes());else{const o=xe(n);if(".priority"===o)f=e.filter.updatePriority(t.eventCache.getNode(),r),d=Zt(t,f,h.isFullyInitialized(),h.isFiltered());else{const l=Ie(n),f=h.getNode().getImmediateChild(o);let _;if(De(l))_=r;else{const e=source.getCompleteChild(o);_=null!=e?".priority"===Pe(l)&&e.getChild(je(l)).isEmpty()?e:e.updateChild(l,r):gt.EMPTY_NODE}if(f.equals(_))d=t;else{d=Zt(t,e.filter.updateChild(h.getNode(),o,_,l,source,c),h.isFullyInitialized(),e.filter.filtersNodes())}}}return d}function Un(e,t){return e.eventCache.isCompleteForChild(t)}function Ln(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function $n(e,t,path,n,r,o,l,c){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let h,d=t;h=De(path)?n:new sn(null).setTree(path,n);const f=t.serverCache.getNode();return h.children.inorderTraversal(((n,h)=>{if(f.hasChild(n)){const f=Ln(0,t.serverCache.getNode().getImmediateChild(n),h);d=An(e,d,new Ce(n),f,r,o,l,c)}})),h.children.inorderTraversal(((n,h)=>{const _=!t.serverCache.isCompleteForChild(n)&&null===h.value;if(!f.hasChild(n)&&!_){const f=Ln(0,t.serverCache.getNode().getImmediateChild(n),h);d=An(e,d,new Ce(n),f,r,o,l,c)}})),d}class qn{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new kt(n.getIndex()),filter=(o=n).loadsAllData()?new kt(o.getIndex()):o.hasLimit()?new Pt(o):new It(o);var o;this.processor_=function(filter){return{filter:filter}}(filter);const l=t.serverCache,c=t.eventCache,h=r.updateFullNode(gt.EMPTY_NODE,l.getNode(),null),d=filter.updateFullNode(gt.EMPTY_NODE,c.getNode(),null),f=new Qt(h,l.isFullyInitialized(),r.filtersNodes()),_=new Qt(d,c.isFullyInitialized(),filter.filtersNodes());this.viewCache_=Xt(_,f),this.eventGenerator_=new Yt(this.query_)}get query(){return this.query_}}function Bn(view,path){const e=nn(view.viewCache_);return e&&(view.query._queryParams.loadsAllData()||!De(path)&&!e.getImmediateChild(xe(path)).isEmpty())?e.getChild(path):null}function Wn(view){return 0===view.eventRegistrations_.length}function Hn(view,e,t){const n=[];if(t){Object(l.f)(null==e,"A cancel should cancel all event registrations.");const path=view.query._path;view.eventRegistrations_.forEach((e=>{const r=e.createCancelEvent(t,path);r&&n.push(r)}))}if(e){let t=[];for(let i=0;i<view.eventRegistrations_.length;++i){const n=view.eventRegistrations_[i];if(n.matches(e)){if(e.hasAnyCallback()){t=t.concat(view.eventRegistrations_.slice(i+1));break}}else t.push(n)}view.eventRegistrations_=t}else view.eventRegistrations_=[];return n}function zn(view,e,t,n){e.type===Wt.MERGE&&null!==e.source.queryId&&(Object(l.f)(nn(view.viewCache_),"We should always have a full cache before handling merges"),Object(l.f)(tn(view.viewCache_),"Missing event cache, even though we have a server cache"));const r=view.viewCache_,o=Rn(view.processor_,r,e,t,n);var c,h;return c=view.processor_,h=o.viewCache,Object(l.f)(h.eventCache.getNode().isIndexed(c.filter.getIndex()),"Event snap not indexed"),Object(l.f)(h.serverCache.getNode().isIndexed(c.filter.getIndex()),"Server snap not indexed"),Object(l.f)(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),view.viewCache_=o.viewCache,Vn(view,o.changes,o.viewCache.eventCache.getNode(),null)}function Vn(view,e,t,n){const r=n?[n]:view.eventRegistrations_;return function(e,t,n,r){const o=[],l=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&l.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Jt(e,o,"child_removed",t,r,n),Jt(e,o,"child_added",t,r,n),Jt(e,o,"child_moved",l,r,n),Jt(e,o,"child_changed",t,r,n),Jt(e,o,"value",t,r,n),o}(view.eventGenerator_,e,t,r)}let Gn,Kn;class Qn{constructor(){this.views=new Map}}function Yn(e,t,n,r){const o=t.source.queryId;if(null!==o){const view=e.views.get(o);return Object(l.f)(null!=view,"SyncTree gave us an op for an invalid query."),zn(view,t,n,r)}{let o=[];for(const view of e.views.values())o=o.concat(zn(view,t,n,r));return o}}function Jn(e,t,n,r,o){const l=t._queryIdentifier,view=e.views.get(l);if(!view){let e=Cn(n,o?r:null),l=!1;e?l=!0:r instanceof gt?(e=Sn(n,r),l=!1):(e=gt.EMPTY_NODE,l=!1);const c=Xt(new Qt(e,l,!1),new Qt(r,o,!1));return new qn(t,c)}return view}function Xn(e,t,n,r,o,l){const view=Jn(e,t,r,o,l);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,view),function(view,e){view.eventRegistrations_.push(e)}(view,n),function(view,e){const t=view.viewCache_.eventCache,n=[];t.getNode().isLeafNode()||t.getNode().forEachChild(at,((e,t)=>{n.push(Ct(e,t))}));return t.isFullyInitialized()&&n.push(Ot(t.getNode())),Vn(view,n,t.getNode(),e)}(view,n)}function Zn(e,t,n,r){const o=t._queryIdentifier,c=[];let h=[];const d=sr(e);if("default"===o)for(const[t,view]of e.views.entries())h=h.concat(Hn(view,n,r)),Wn(view)&&(e.views.delete(t),view.query._queryParams.loadsAllData()||c.push(view.query));else{const view=e.views.get(o);view&&(h=h.concat(Hn(view,n,r)),Wn(view)&&(e.views.delete(o),view.query._queryParams.loadsAllData()||c.push(view.query)))}return d&&!sr(e)&&c.push(new(Object(l.f)(Gn,"Reference.ts has not been loaded"),Gn)(t._repo,t._path)),{removed:c,events:h}}function er(e){const t=[];for(const view of e.views.values())view.query._queryParams.loadsAllData()||t.push(view);return t}function nr(e,path){let t=null;for(const view of e.views.values())t=t||Bn(view,path);return t}function rr(e,t){if(t._queryParams.loadsAllData())return or(e);{const n=t._queryIdentifier;return e.views.get(n)}}function ir(e,t){return null!=rr(e,t)}function sr(e){return null!=or(e)}function or(e){for(const view of e.views.values())if(view.query._queryParams.loadsAllData())return view;return null}let ar=1;class lr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new sn(null),this.pendingWriteTree_={visibleWrites:on.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function cr(e,path,t,n,r){return function(e,path,t,n,r){Object(l.f)(n>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:path,snap:t,writeId:n,visible:r}),r&&(e.visibleWrites=an(e.visibleWrites,path,t)),e.lastWriteId=n}(e.pendingWriteTree_,path,t,n,r),r?yr(e,new Gt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},path,t)):[]}function ur(e,path,t,n){!function(e,path,t,n){Object(l.f)(n>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:path,children:t,writeId:n,visible:!0}),e.visibleWrites=ln(e.visibleWrites,path,t),e.lastWriteId=n}(e.pendingWriteTree_,path,t,n);const r=sn.fromObject(t);return yr(e,new Kt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},path,r))}function dr(e,t,n=!1){const r=function(e,t){for(let i=0;i<e.allWrites.length;i++){const n=e.allWrites[i];if(n.writeId===t)return n}return null}(e.pendingWriteTree_,t);if(bn(e.pendingWriteTree_,t)){let t=new sn(null);return null!=r.snap?t=t.set(Se(),!0):H(r.children,(e=>{t=t.set(new Ce(e),!0)})),yr(e,new zt(r.path,t,n))}return[]}function pr(e,path,t){return yr(e,new Gt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},path,t))}function fr(e,t,n,r,o=!1){const path=t._path,l=e.syncPointTree_.get(path);let c=[];if(l&&("default"===t._queryIdentifier||ir(l,t))){const h=Zn(l,t,n,r);0===l.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(path));const d=h.removed;if(c=h.events,!o){const n=-1!==d.findIndex((e=>e._queryParams.loadsAllData())),o=e.syncPointTree_.findOnPath(path,((e,t)=>sr(t)));if(n&&!o){const t=e.syncPointTree_.subtree(path);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&sr(t)){return[or(t)]}{let e=[];return t&&(e=er(t)),H(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let i=0;i<n.length;++i){const view=n[i],t=view.query,r=Cr(e,view);e.listenProvider_.startListening(Tr(t),Sr(e,t),r.hashFn,r.onComplete)}}}if(!o&&d.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(Tr(t),n)}else d.forEach((t=>{const n=e.queryToTagMap.get(xr(t));e.listenProvider_.stopListening(Tr(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=xr(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,d)}return c}function _r(e,path,t,n){const r=kr(e,n);if(null!=r){const n=Ir(r),o=n.path,l=n.queryId,c=Ne(o,path);return Pr(e,o,new Gt(Ht(l),c,t))}return[]}function gr(e,t,n,r=!1){const path=t._path;let o=null,c=!1;e.syncPointTree_.foreachOnPath(path,((e,t)=>{const n=Ne(e,path);o=o||nr(t,n),c=c||sr(t)}));let h,d=e.syncPointTree_.get(path);if(d?(c=c||sr(d),o=o||nr(d,Se())):(d=new Qn,e.syncPointTree_=e.syncPointTree_.set(path,d)),null!=o)h=!0;else{h=!1,o=gt.EMPTY_NODE;e.syncPointTree_.subtree(path).foreachChild(((e,t)=>{const n=nr(t,Se());n&&(o=o.updateImmediateChild(e,n))}))}const f=ir(d,t);if(!f&&!t._queryParams.loadsAllData()){const n=xr(t);Object(l.f)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=ar++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let _=Xn(d,t,n,mn(e.pendingWriteTree_,path),o,h);if(!f&&!c&&!r){const view=rr(d,t);_=_.concat(function(e,t,view){const path=t._path,n=Sr(e,t),r=Cr(e,view),o=e.listenProvider_.startListening(Tr(t),n,r.hashFn,r.onComplete),c=e.syncPointTree_.subtree(path);if(n)Object(l.f)(!sr(c.value),"If we're adding a query, it shouldn't be shadowed");else{const t=c.fold(((e,t,n)=>{if(!De(e)&&t&&sr(t))return[or(t).query];{let e=[];return t&&(e=e.concat(er(t).map((view=>view.query)))),H(n,((t,n)=>{e=e.concat(n)})),e}}));for(let i=0;i<t.length;++i){const n=t[i];e.listenProvider_.stopListening(Tr(n),Sr(e,n))}}return o}(e,t,view))}return _}function mr(e,path,t){const n=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(path,((e,t)=>{const n=nr(t,Ne(e,path));if(n)return n}));return On(n,path,r,t,!0)}function vr(e,t){const path=t._path;let n=null;e.syncPointTree_.foreachOnPath(path,((e,t)=>{const r=Ne(e,path);n=n||nr(t,r)}));let r=e.syncPointTree_.get(path);r?n=n||nr(r,Se()):(r=new Qn,e.syncPointTree_=e.syncPointTree_.set(path,r));const o=null!=n,l=o?new Qt(n,!0,!1):null;return function(view){return tn(view.viewCache_)}(Jn(r,t,mn(e.pendingWriteTree_,t._path),o?l.getNode():gt.EMPTY_NODE,o))}function yr(e,t){return wr(t,e.syncPointTree_,null,mn(e.pendingWriteTree_,Se()))}function wr(e,t,n,r){if(De(e.path))return Or(e,t,n,r);{const o=t.get(Se());null==n&&null!=o&&(n=nr(o,Se()));let l=[];const c=xe(e.path),h=e.operationForChild(c),d=t.children.get(c);if(d&&h){const e=n?n.getImmediateChild(c):null,t=Tn(r,c);l=l.concat(wr(h,d,e,t))}return o&&(l=l.concat(Yn(o,e,r,n))),l}}function Or(e,t,n,r){const o=t.get(Se());null==n&&null!=o&&(n=nr(o,Se()));let l=[];return t.children.inorderTraversal(((t,o)=>{const c=n?n.getImmediateChild(t):null,h=Tn(r,t),d=e.operationForChild(t);d&&(l=l.concat(Or(d,o,c,h)))})),o&&(l=l.concat(Yn(o,e,r,n))),l}function Cr(e,view){const t=view.query,n=Sr(e,t);return{hashFn:()=>{const e=function(view){return view.viewCache_.serverCache.getNode()}(view)||gt.EMPTY_NODE;return e.hash()},onComplete:r=>{if("ok"===r)return n?function(e,path,t){const n=kr(e,t);if(n){const t=Ir(n),r=t.path,o=t.queryId,l=Ne(r,path);return Pr(e,r,new Vt(Ht(o),l))}return[]}(e,t._path,n):function(e,path){return yr(e,new Vt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},path))}(e,t._path);{const n=function(code,e){let t="Unknown Error";"too_big"===code?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===code?t="Client doesn't have permission to access the desired data.":"unavailable"===code&&(t="The service is unavailable");const n=new Error(code+" at "+e._path.toString()+": "+t);return n.code=code.toUpperCase(),n}(r,t);return fr(e,t,null,n)}}}}function Sr(e,t){const n=xr(t);return e.queryToTagMap.get(n)}function xr(e){return e._path.toString()+"$"+e._queryIdentifier}function kr(e,t){return e.tagToQueryMap.get(t)}function Ir(e){const t=e.indexOf("$");return Object(l.f)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ce(e.substr(0,t))}}function Pr(e,t,n){const r=e.syncPointTree_.get(t);Object(l.f)(r,"Missing sync point for query tag that we're tracking");return Yn(r,n,mn(e.pendingWriteTree_,t),null)}function Tr(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Object(l.f)(Kn,"Reference.ts has not been loaded"),Kn)(e._repo,e._path):e}class jr{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new jr(t)}node(){return this.node_}}class Er{constructor(e,path){this.syncTree_=e,this.path_=path}getImmediateChild(e){const t=Ee(this.path_,e);return new Er(this.syncTree_,t)}node(){return mr(this.syncTree_,this.path_)}}const Dr=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Nr=function(e,t,n){return e&&"object"==typeof e?(Object(l.f)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Rr(e[".sv"],t,n):"object"==typeof e[".sv"]?Mr(e[".sv"],t):void Object(l.f)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Rr=function(e,t,n){if("timestamp"===e)return n.timestamp;Object(l.f)(!1,"Unexpected server value: "+e)},Mr=function(e,t,n){e.hasOwnProperty("increment")||Object(l.f)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&Object(l.f)(!1,"Unexpected increment value: "+r);const o=t.node();if(Object(l.f)(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;const c=o.getValue();return"number"!=typeof c?r:c+r},Ar=function(path,e,t,n){return Ur(e,new Er(t,path),n)},Fr=function(e,t,n){return Ur(e,new jr(t),n)};function Ur(e,t,n){const r=e.getPriority().val(),o=Nr(r,t.getImmediateChild(".priority"),n);let l;if(e.isLeafNode()){const r=e,l=Nr(r.getValue(),t,n);return l!==r.getValue()||o!==r.getPriority().val()?new ot(l,vt(o)):e}{const r=e;return l=r,o!==r.getPriority().val()&&(l=l.updatePriority(new ot(o))),r.forEachChild(at,((e,r)=>{const o=Ur(r,t.getImmediateChild(e),n);o!==r&&(l=l.updateImmediateChild(e,o))})),l}}class Lr{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function $r(e,t){let path=t instanceof Ce?t:new Ce(t),n=e,r=xe(path);for(;null!==r;){const e=Object(l.O)(n.node.children,r)||{children:{},childCount:0};n=new Lr(r,n,e),path=Ie(path),r=xe(path)}return n}function qr(e){return e.node.value}function Br(e,t){e.node.value=t,Gr(e)}function Wr(e){return e.node.childCount>0}function Hr(e,t){H(e.node.children,((n,r)=>{t(new Lr(n,e,r))}))}function zr(e,t,n,r){n&&!r&&t(e),Hr(e,(e=>{zr(e,t,!0,r)})),n&&r&&t(e)}function Vr(e){return new Ce(null===e.parent?e.name:Vr(e.parent)+"/"+e.name)}function Gr(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===qr(e)&&!Wr(e)}(n),o=Object(l.l)(e.node.children,t);r&&o?(delete e.node.children[t],e.node.childCount--,Gr(e)):r||o||(e.node.children[t]=n.node,e.node.childCount++,Gr(e))}(e.parent,e.name,e)}const Kr=/[\[\].#$\/\u0000-\u001F\u007F]/,Qr=/[\[\].#$\u0000-\u001F\u007F]/,Yr=10485760,Jr=function(e){return"string"==typeof e&&0!==e.length&&!Kr.test(e)},Xr=function(e){return"string"==typeof e&&0!==e.length&&!Qr.test(e)},Zr=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!M(e)||e&&"object"==typeof e&&Object(l.l)(e,".sv")},ei=function(e,t,path,n){n&&void 0===t||ti(Object(l.r)(e,"value"),t,path)},ti=function(e,data,t){const path=t instanceof Ce?new Fe(t,e):t;if(void 0===data)throw new Error(e+"contains undefined "+Le(path));if("function"==typeof data)throw new Error(e+"contains a function "+Le(path)+" with contents = "+data.toString());if(M(data))throw new Error(e+"contains "+data.toString()+" "+Le(path));if("string"==typeof data&&data.length>Yr/3&&Object(l.P)(data)>Yr)throw new Error(e+"contains a string greater than "+Yr+" utf8 bytes "+Le(path)+" ('"+data.substring(0,50)+"...')");if(data&&"object"==typeof data){let t=!1,n=!1;if(H(data,((r,o)=>{if(".value"===r)t=!0;else if(".priority"!==r&&".sv"!==r&&(n=!0,!Jr(r)))throw new Error(e+" contains an invalid key ("+r+") "+Le(path)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Object(l.P)(t),Ue(e)}(path,r),ti(e,o,path),function(e){const t=e.parts_.pop();e.byteLength_-=Object(l.P)(t),e.parts_.length>0&&(e.byteLength_-=1)}(path)})),t&&n)throw new Error(e+' contains ".value" child '+Le(path)+" in addition to actual children.")}},ni=function(e,data,path,t){if(t&&void 0===data)return;const n=Object(l.r)(e,"values");if(!data||"object"!=typeof data||Array.isArray(data))throw new Error(n+" must be an object containing the children to replace.");const r=[];H(data,((e,t)=>{const o=new Ce(e);if(ti(n,t,Ee(path,o)),".priority"===Pe(o)&&!Zr(t))throw new Error(n+"contains an invalid value for '"+o.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(o)})),function(e,t){let i,n;for(i=0;i<t.length;i++){n=t[i];const r=Te(n);for(let t=0;t<r.length;t++)if(".priority"===r[t]&&t===r.length-1);else if(!Jr(r[t]))throw new Error(e+"contains an invalid key ("+r[t]+") in path "+n.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Re);let r=null;for(i=0;i<t.length;i++){if(n=t[i],null!==r&&Ae(r,n))throw new Error(e+"contains a path "+r.toString()+" that is ancestor of another path "+n.toString());r=n}}(n,r)},ri=function(e,t,n){if(!n||void 0!==t){if(M(t))throw new Error(Object(l.r)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Zr(t))throw new Error(Object(l.r)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ii=function(e,t,n,r){if(!(r&&void 0===n||Jr(n)))throw new Error(Object(l.r)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},si=function(e,t,n,r){if(!(r&&void 0===n||Xr(n)))throw new Error(Object(l.r)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},oi=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),si(e,t,n,r)},ai=function(e,path){if(".info"===xe(path))throw new Error(e+" failed = Can't modify data under /.info/")},ci=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Jr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Xr(e)}(n))throw new Error(Object(l.r)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class hi{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ui(e,t){let n=null;for(let i=0;i<t.length;i++){const data=t[i],path=data.getPath();null===n||Me(path,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:path}),n.events.push(data)}n&&e.eventLists_.push(n)}function di(e,path,t){ui(e,t),fi(e,(e=>Me(e,path)))}function pi(e,t,n){ui(e,n),fi(e,(e=>Ae(e,t)||Ae(t,e)))}function fi(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){t(r.path)?(_i(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function _i(e){for(let i=0;i<e.events.length;i++){const t=e.events[i];if(null!==t){e.events[i]=null;const n=t.getEventRunner();I&&j("event: "+t.toString()),K(n)}}}const gi="repo_interrupt",mi=25;class bi{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hi,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ft(),this.transactionQueueTree_=new Lr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function vi(e,t,n){if(e.stats_=ce(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Mt(e.repoInfo_,((t,data,n,r)=>{Oi(e,t,data,n,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>Ci(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(l.R)(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Be(e.repoInfo_,t,((t,data,n,r)=>{Oi(e,t,data,n,r)}),(t=>{Ci(e,t)}),(t=>{!function(e,t){H(t,((t,n)=>{Si(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return le[n]||(le[n]=t()),le[n]}(e.repoInfo_,(()=>new Bt(e.stats_,e.server_))),e.infoData_=new At,e.infoSyncTree_=new lr({startListening:(t,n,r,o)=>{let l=[];const c=e.infoData_.getNode(t._path);return c.isEmpty()||(l=pr(e.infoSyncTree_,t._path,c),setTimeout((()=>{o("ok")}),0)),l},stopListening:()=>{}}),Si(e,"connected",!1),e.serverSyncTree_=new lr({startListening:(t,n,r,o)=>(e.server_.listen(t,r,n,((n,data)=>{const r=o(n,data);pi(e.eventQueue_,t._path,r)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function yi(e){const t=e.infoData_.getNode(new Ce(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function wi(e){return Dr({timestamp:yi(e)})}function Oi(e,t,data,n,r){e.dataUpdateCount++;const path=new Ce(t);data=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,data):data;let o=[];if(r)if(n){const t=Object(l.L)(data,(e=>vt(e)));o=function(e,path,t,n){const r=kr(e,n);if(r){const n=Ir(r),o=n.path,l=n.queryId,c=Ne(o,path),h=sn.fromObject(t);return Pr(e,o,new Kt(Ht(l),c,h))}return[]}(e.serverSyncTree_,path,t,r)}else{const t=vt(data);o=_r(e.serverSyncTree_,path,t,r)}else if(n){const t=Object(l.L)(data,(e=>vt(e)));o=function(e,path,t){const n=sn.fromObject(t);return yr(e,new Kt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},path,n))}(e.serverSyncTree_,path,t)}else{const t=vt(data);o=pr(e.serverSyncTree_,path,t)}let c=path;o.length>0&&(c=Mi(e,path)),pi(e.eventQueue_,c,o)}function Ci(e,t){Si(e,"connected",t),!1===t&&function(e){Ei(e,"onDisconnectEvents");const t=wi(e),n=Ft();$t(e.onDisconnect_,Se(),((path,r)=>{const o=Ar(path,r,e.serverSyncTree_,t);Ut(n,path,o)}));let r=[];$t(n,Se(),((path,t)=>{r=r.concat(pr(e.serverSyncTree_,path,t));const n=$i(e,path);Mi(e,n)})),e.onDisconnect_=Ft(),pi(e.eventQueue_,Se(),r)}(e)}function Si(e,t,n){const path=new Ce("/.info/"+t),r=vt(n);e.infoData_.updateSnapshot(path,r);const o=pr(e.infoSyncTree_,path,r);pi(e.eventQueue_,path,o)}function xi(e){return e.nextWriteId_++}function ki(e,path,t,n,r){Ei(e,"set",{path:path.toString(),value:t,priority:n});const o=wi(e),l=vt(t,n),c=mr(e.serverSyncTree_,path),h=Fr(l,c,o),d=xi(e),f=cr(e.serverSyncTree_,path,h,d,!0);ui(e.eventQueue_,f),e.server_.put(path.toString(),l.val(!0),((t,n)=>{const o="ok"===t;o||R("set at "+path+" failed: "+t);const l=dr(e.serverSyncTree_,d,!o);pi(e.eventQueue_,path,l),Di(e,r,t,n)}));const _=$i(e,path);Mi(e,_),pi(e.eventQueue_,_,[])}function Ii(e,path,t){e.server_.onDisconnectCancel(path.toString(),((n,r)=>{"ok"===n&&Lt(e.onDisconnect_,path),Di(e,t,n,r)}))}function Pi(e,path,t,n){const r=vt(t);e.server_.onDisconnectPut(path.toString(),r.val(!0),((t,o)=>{"ok"===t&&Ut(e.onDisconnect_,path,r),Di(e,n,t,o)}))}function Ti(e,t,n){let r;r=".info"===xe(t._path)?fr(e.infoSyncTree_,t,n):fr(e.serverSyncTree_,t,n),di(e.eventQueue_,t._path,r)}function ji(e){e.persistentConnection_&&e.persistentConnection_.interrupt(gi)}function Ei(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),j(n,...t)}function Di(e,t,n,r){t&&K((()=>{if("ok"===n)t(null);else{const code=(n||"error").toUpperCase();let e=code;r&&(e+=": "+r);const o=new Error(e);o.code=code,t(o)}}))}function Ni(e,path,t){return mr(e.serverSyncTree_,path,t)||gt.EMPTY_NODE}function Ri(e,t=e.transactionQueueTree_){if(t||Li(e,t),qr(t)){const n=Fi(e,t);Object(l.f)(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,path,t){const n=t.map((e=>e.currentWriteId)),r=Ni(e,path,n);let o=r;const c=r.hash();for(let i=0;i<t.length;i++){const e=t[i];Object(l.f)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const n=Ne(path,e.path);o=o.updateChild(n,e.currentOutputSnapshotRaw)}const h=o.val(!0),d=path;e.server_.put(d.toString(),h,(n=>{Ei(e,"transaction put response",{path:d.toString(),status:n});let r=[];if("ok"===n){const n=[];for(let i=0;i<t.length;i++)t[i].status=2,r=r.concat(dr(e.serverSyncTree_,t[i].currentWriteId)),t[i].onComplete&&n.push((()=>t[i].onComplete(null,!0,t[i].currentOutputSnapshotResolved))),t[i].unwatcher();Li(e,$r(e.transactionQueueTree_,path)),Ri(e,e.transactionQueueTree_),pi(e.eventQueue_,path,r);for(let i=0;i<n.length;i++)K(n[i])}else{if("datastale"===n)for(let i=0;i<t.length;i++)3===t[i].status?t[i].status=4:t[i].status=0;else{R("transaction at "+d.toString()+" failed: "+n);for(let i=0;i<t.length;i++)t[i].status=4,t[i].abortReason=n}Mi(e,path)}}),c)}(e,Vr(t),n)}else Wr(t)&&Hr(t,(t=>{Ri(e,t)}))}function Mi(e,t){const n=Ai(e,t),path=Vr(n);return function(e,t,path){if(0===t.length)return;const n=[];let r=[];const o=t.filter((q=>0===q.status)),c=o.map((q=>q.currentWriteId));for(let i=0;i<t.length;i++){const o=t[i],d=Ne(path,o.path);let f,_=!1;if(Object(l.f)(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===o.status)_=!0,f=o.abortReason,r=r.concat(dr(e.serverSyncTree_,o.currentWriteId,!0));else if(0===o.status)if(o.retryCount>=mi)_=!0,f="maxretry",r=r.concat(dr(e.serverSyncTree_,o.currentWriteId,!0));else{const n=Ni(e,o.path,c);o.currentInputSnapshot=n;const h=t[i].update(n.val());if(void 0!==h){ti("transaction failed: Data returned ",h,o.path);let t=vt(h);"object"==typeof h&&null!=h&&Object(l.l)(h,".priority")||(t=t.updatePriority(n.getPriority()));const d=o.currentWriteId,f=wi(e),_=Fr(t,n,f);o.currentOutputSnapshotRaw=t,o.currentOutputSnapshotResolved=_,o.currentWriteId=xi(e),c.splice(c.indexOf(d),1),r=r.concat(cr(e.serverSyncTree_,o.path,_,o.currentWriteId,o.applyLocally)),r=r.concat(dr(e.serverSyncTree_,d,!0))}else _=!0,f="nodata",r=r.concat(dr(e.serverSyncTree_,o.currentWriteId,!0))}pi(e.eventQueue_,path,r),r=[],_&&(t[i].status=2,h=t[i].unwatcher,setTimeout(h,Math.floor(0)),t[i].onComplete&&("nodata"===f?n.push((()=>t[i].onComplete(null,!1,t[i].currentInputSnapshot))):n.push((()=>t[i].onComplete(new Error(f),!1,null)))))}var h;Li(e,e.transactionQueueTree_);for(let i=0;i<n.length;i++)K(n[i]);Ri(e,e.transactionQueueTree_)}(e,Fi(e,n),path),path}function Ai(e,path){let t,n=e.transactionQueueTree_;for(t=xe(path);null!==t&&void 0===qr(n);)n=$r(n,t),t=xe(path=Ie(path));return n}function Fi(e,t){const n=[];return Ui(e,t,n),n.sort(((a,b)=>a.order-b.order)),n}function Ui(e,t,n){const r=qr(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Hr(t,(t=>{Ui(e,t,n)}))}function Li(e,t){const n=qr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Br(t,n.length>0?n:void 0)}Hr(t,(t=>{Li(e,t)}))}function $i(e,path){const t=Vr(Ai(e,path)),n=$r(e.transactionQueueTree_,path);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(n,(t=>{qi(e,t)})),qi(e,n),zr(n,(t=>{qi(e,t)})),t}function qi(e,t){const n=qr(t);if(n){const r=[];let o=[],c=-1;for(let i=0;i<n.length;i++)3===n[i].status||(1===n[i].status?(Object(l.f)(c===i-1,"All SENT items should be at beginning of queue."),c=i,n[i].status=3,n[i].abortReason="set"):(Object(l.f)(0===n[i].status,"Unexpected transaction status in abort"),n[i].unwatcher(),o=o.concat(dr(e.serverSyncTree_,n[i].currentWriteId,!0)),n[i].onComplete&&r.push(n[i].onComplete.bind(null,new Error("set"),!1,null))));-1===c?Br(t,void 0):n.length=c+1,pi(e.eventQueue_,Vr(t),o);for(let i=0;i<r.length;i++)K(r[i])}}const Bi=function(e,t){const n=Wi(e),r=n.namespace;"firebase.com"===n.domain&&N(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||N("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&R("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const o="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new ie(n.host,n.secure,r,o,t,"",r!==n.subdomain),path:new Ce(n.pathString)}},Wi=function(e){let t="",n="",r="",o="",l="",c=!0,h="https",d=443;if("string"==typeof e){let f=e.indexOf("//");f>=0&&(h=e.substring(0,f-1),e=e.substring(f+2));let _=e.indexOf("/");-1===_&&(_=e.length);let m=e.indexOf("?");-1===m&&(m=e.length),t=e.substring(0,Math.min(_,m)),_<m&&(o=function(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let e=n[i];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}t+="/"+e}return t}(e.substring(_,m)));const v=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):R(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,m)));f=t.indexOf(":"),f>=0?(c="https"===h||"wss"===h,d=parseInt(t.substring(f+1),10)):f=t.length;const y=t.slice(0,f);if("localhost"===y.toLowerCase())n="localhost";else if(y.split(".").length<=2)n=y;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),l=r}"ns"in v&&(l=v.ns)}return{host:t,port:d,domain:n,subdomain:r,secure:c,scheme:h,pathString:o,namespace:l}},Hi="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",zi=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const o=new Array(8);for(i=7;i>=0;i--)o[i]=Hi.charAt(n%64),n=Math.floor(n/64);Object(l.f)(0===n,"Cannot push at time == 0");let c=o.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)c+=Hi.charAt(t[i]);return Object(l.f)(20===c.length,"nextPushId: Length should be 20."),c}}();class Vi{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Object(l.R)(this.snapshot.exportVal())}}class Gi{constructor(e,t,path){this.eventRegistration=e,this.error=t,this.path=path}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Ki{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Object(l.f)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Qi{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new l.a;return Ii(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){ai("OnDisconnect.remove",this._path);const e=new l.a;return Pi(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){ai("OnDisconnect.set",this._path),ei("OnDisconnect.set",e,this._path,!1);const t=new l.a;return Pi(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){ai("OnDisconnect.setWithPriority",this._path),ei("OnDisconnect.setWithPriority",e,this._path,!1),ri("OnDisconnect.setWithPriority",t,!1);const n=new l.a;return function(e,path,t,n,r){const o=vt(t,n);e.server_.onDisconnectPut(path.toString(),o.val(!0),((t,n)=>{"ok"===t&&Ut(e.onDisconnect_,path,o),Di(0,r,t,n)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){ai("OnDisconnect.update",this._path),ni("OnDisconnect.update",e,this._path,!1);const t=new l.a;return function(e,path,t,n){if(Object(l.C)(t))return j("onDisconnect().update() called with empty data.  Don't do anything."),void Di(0,n,"ok",void 0);e.server_.onDisconnectMerge(path.toString(),t,((r,o)=>{"ok"===r&&H(t,((t,n)=>{const r=vt(n);Ut(e.onDisconnect_,Ee(path,t),r)})),Di(0,n,r,o)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class Yi{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return De(this._path)?null:Pe(this._path)}get ref(){return new es(this._repo,this._path)}get _queryIdentifier(){const e=Rt(this._queryParams),t=B(e);return"{}"===t?"default":t}get _queryObject(){return Rt(this._queryParams)}isEqual(e){if(!((e=Object(l.x)(e))instanceof Yi))return!1;const t=this._repo===e._repo,n=Me(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(path){let e="";for(let i=path.pieceNum_;i<path.pieces_.length;i++)""!==path.pieces_[i]&&(e+="/"+encodeURIComponent(String(path.pieces_[i])));return e||"/"}(this._path)}}function Ji(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Xi(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Ge){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==A)throw new Error(r);if("string"!=typeof t)throw new Error(o)}if(e.hasEnd()){if(e.getIndexEndName()!==F)throw new Error(r);if("string"!=typeof n)throw new Error(o)}}else if(e.getIndex()===at){if(null!=t&&!Zr(t)||null!=n&&!Zr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(l.f)(e.getIndex()instanceof yt||e.getIndex()===wt,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Zi(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class es extends Yi{constructor(e,path){super(e,path,new Tt,!1)}get parent(){const e=je(this._path);return null===e?null:new es(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class ts{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(path){const e=new Ce(path),t=is(this.ref,path);return new ts(this._node.getChild(e),t,at)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new ts(n,is(this.ref,t),at))))}hasChild(path){const e=new Ce(path);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ns(e,path){return(e=Object(l.x)(e))._checkNotDeleted("ref"),void 0!==path?is(e._root,path):e._root}function rs(e,t){(e=Object(l.x)(e))._checkNotDeleted("refFromURL");const n=Bi(t,e._repo.repoInfo_.nodeAdmin);ci("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||N("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),ns(e,n.path.toString())}function is(e,path){return null===xe((e=Object(l.x)(e))._path)?oi("child","path",path,!1):si("child","path",path,!1),new es(e._repo,Ee(e._path,path))}function ss(e,t){e=Object(l.x)(e),ai("push",e._path),ei("push",t,e._path,!0);const n=yi(e._repo),r=zi(n),o=is(e,r),c=is(e,r);let h;return h=null!=t?as(c,t).then((()=>c)):Promise.resolve(c),o.then=h.then.bind(h),o.catch=h.then.bind(h,void 0),o}function os(e){return ai("remove",e._path),as(e,null)}function as(e,t){e=Object(l.x)(e),ai("set",e._path),ei("set",t,e._path,!1);const n=new l.a;return ki(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function ls(e,t){e=Object(l.x)(e),ai("setPriority",e._path),ri("setPriority",t,!1);const n=new l.a;return ki(e._repo,Ee(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}function cs(e,t,n){if(ai("setWithPriority",e._path),ei("setWithPriority",t,e._path,!1),ri("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new l.a;return ki(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}function hs(e,t){ni("update",t,e._path,!1);const n=new l.a;return function(e,path,t,n){Ei(e,"update",{path:path.toString(),value:t});let r=!0;const o=wi(e),l={};if(H(t,((t,n)=>{r=!1,l[t]=Ar(Ee(path,t),vt(n),e.serverSyncTree_,o)})),r)j("update() called with empty data.  Don't do anything."),Di(0,n,"ok",void 0);else{const r=xi(e),o=ur(e.serverSyncTree_,path,l,r);ui(e.eventQueue_,o),e.server_.merge(path.toString(),t,((t,o)=>{const l="ok"===t;l||R("update at "+path+" failed: "+t);const c=dr(e.serverSyncTree_,r,!l),h=c.length>0?Mi(e,path):path;pi(e.eventQueue_,h,c),Di(0,n,t,o)})),H(t,(t=>{const n=$i(e,Ee(path,t));Mi(e,n)})),pi(e.eventQueue_,path,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function us(e){e=Object(l.x)(e);const t=new Ki((()=>{})),n=new ds(t);return function(e,t,n){const r=vr(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const o=vt(r).withIndex(t._queryParams.getIndex());let l;if(gr(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())l=pr(e.serverSyncTree_,t._path,o);else{const n=Sr(e.serverSyncTree_,t);l=_r(e.serverSyncTree_,t._path,o,n)}return pi(e.eventQueue_,t._path,l),fr(e.serverSyncTree_,t,n,null,!0),o}),(n=>(Ei(e,"get for query "+Object(l.R)(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new ts(t,new es(e._repo,e._path),e._queryParams.getIndex())))}class ds{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Vi("value",this,new ts(e.snapshotNode,new es(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,path){return this.callbackContext.hasCancelCallback?new Gi(this,e,path):null}matches(e){return e instanceof ds&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class ps{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,path){return this.callbackContext.hasCancelCallback?new Gi(this,e,path):null}createEvent(e,t){Object(l.f)(null!=e.childName,"Child events should have a childName.");const n=is(new es(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Vi(e.type,this,new ts(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ps&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function fs(e,t,n,r,o){let l;if("object"==typeof r&&(l=void 0,o=r),"function"==typeof r&&(l=r),o&&o.onlyOnce){const t=n,r=(n,r)=>{Ti(e._repo,e,h),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const c=new Ki(n,l||void 0),h="value"===t?new ds(c):new ps(t,c);return function(e,t,n){let r;r=".info"===xe(t._path)?gr(e.infoSyncTree_,t,n):gr(e.serverSyncTree_,t,n),di(e.eventQueue_,t._path,r)}(e._repo,e,h),()=>Ti(e._repo,e,h)}function _s(e,t,n,r){return fs(e,"value",t,n,r)}function gs(e,t,n,r){return fs(e,"child_added",t,n,r)}function ms(e,t,n,r){return fs(e,"child_changed",t,n,r)}function bs(e,t,n,r){return fs(e,"child_moved",t,n,r)}function vs(e,t,n,r){return fs(e,"child_removed",t,n,r)}function ys(e,t,n){let r=null;const o=n?new Ki(n):null;"value"===t?r=new ds(o):t&&(r=new ps(t,o)),Ti(e._repo,e,r)}class ws{}class Os extends ws{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ei("endAt",this._value,e._path,!0);const t=Et(e._queryParams,this._value,this._key);if(Zi(t),Xi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Yi(e._repo,e._path,t,e._orderByCalled)}}function Cs(e,t){return ii("endAt","key",t,!0),new Os(e,t)}class Ss extends ws{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ei("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===Ge||n?Et(e,t,n):Et(e,t,A),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(Zi(t),Xi(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Yi(e._repo,e._path,t,e._orderByCalled)}}function xs(e,t){return ii("endBefore","key",t,!0),new Ss(e,t)}class ks extends ws{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ei("startAt",this._value,e._path,!0);const t=jt(e._queryParams,this._value,this._key);if(Zi(t),Xi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Yi(e._repo,e._path,t,e._orderByCalled)}}function Is(e=null,t){return ii("startAt","key",t,!0),new ks(e,t)}class Ps extends ws{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ei("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===Ge||n?jt(e,t,n):jt(e,t,F),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(Zi(t),Xi(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Yi(e._repo,e._path,t,e._orderByCalled)}}function Ts(e,t){return ii("startAfter","key",t,!0),new Ps(e,t)}class js extends ws{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Yi(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}function Es(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new js(e)}class Ds extends ws{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Yi(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}function Ns(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Ds(e)}class Rs extends ws{constructor(e){super(),this._path=e}_apply(e){Ji(e,"orderByChild");const t=new Ce(this._path);if(De(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new yt(t),r=Dt(e._queryParams,n);return Xi(r),new Yi(e._repo,e._path,r,!0)}}function Ms(path){if("$key"===path)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===path)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===path)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return si("orderByChild","path",path,!1),new Rs(path)}class As extends ws{_apply(e){Ji(e,"orderByKey");const t=Dt(e._queryParams,Ge);return Xi(t),new Yi(e._repo,e._path,t,!0)}}function Fs(){return new As}class Us extends ws{_apply(e){Ji(e,"orderByPriority");const t=Dt(e._queryParams,at);return Xi(t),new Yi(e._repo,e._path,t,!0)}}function Ls(){return new Us}class $s extends ws{_apply(e){Ji(e,"orderByValue");const t=Dt(e._queryParams,wt);return Xi(t),new Yi(e._repo,e._path,t,!0)}}function qs(){return new $s}class Bs extends ws{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(ei("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Os(this._value,this._key)._apply(new ks(this._value,this._key)._apply(e))}}function Ws(e,t){return ii("equalTo","key",t,!0),new Bs(e,t)}function Hs(e,...t){let n=Object(l.x)(e);for(const e of t)n=e._apply(n);return n}!function(e){Object(l.f)(!Gn,"__referenceConstructor has already been defined"),Gn=e}(es),function(e){Object(l.f)(!Kn,"__referenceConstructor has already been defined"),Kn=e}(es);const zs="FIREBASE_DATABASE_EMULATOR_HOST",Vs={};let Gs=!1;function Ks(t,n,r,o,l){let c=o||t.options.databaseURL;void 0===c&&(t.options.projectId||N("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),j("Using default host for project ",t.options.projectId),c=`${t.options.projectId}-default-rtdb.firebaseio.com`);let h,d,f=Bi(c,l),_=f.repoInfo;void 0!==e&&e.env&&(d=e.env[zs]),d?(h=!0,c=`http://${d}?ns=${_.namespace}`,f=Bi(c,l),_=f.repoInfo):h=!f.repoInfo.secure;const m=l&&h?new X(X.OWNER):new J(t.name,t.options,n);ci("Invalid Firebase Database URL",f),De(f.path)||N("Database URL must point to the root of a Firebase Database (not including a child path).");const v=function(e,t,n,r){let o=Vs[t.name];o||(o={},Vs[t.name]=o);let l=o[e.toURLString()];l&&N("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return l=new bi(e,Gs,n,r),o[e.toURLString()]=l,l}(_,t,m,new Y(t.name,r));return new Qs(v,t)}class Qs{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(vi(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new es(this._repo,Se())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=Vs[t];n&&n[e.key]===e||N(`Database ${t}(${e.repoInfo_}) has already been deleted.`),ji(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&N("Cannot call "+e+" on a deleted database.")}}function Ys(){ge.IS_TRANSPORT_INITIALIZED&&R("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Js(){Ys(),de.forceDisallow()}function Xs(){Ys(),_e.forceDisallow(),de.forceAllow()}function Zs(e,t,n,r={}){(e=Object(l.x)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&N("Cannot call useEmulator() after instance has already been initialized.");const o=e._repoInternal;let c;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&N('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new X(X.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:Object(l.m)(r.mockUserToken,e.app.options.projectId);c=new X(t)}!function(e,t,n,r){e.repoInfo_=new ie(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(o,t,n,c)}function eo(e){(e=Object(l.x)(e))._checkNotDeleted("goOffline"),ji(e._repo)}function to(e){var t;(e=Object(l.x)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(gi)}function no(e,t){T(e,t)}const ro={".sv":"timestamp"};function io(){return ro}function so(e){return{".sv":{increment:e}}}class oo{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function ao(e,t,n){var r;if(e=Object(l.x)(e),ai("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const o=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,c=new l.a,h=_s(e,(()=>{}));return function(e,path,t,n,r,o){Ei(e,"transaction on "+path);const c={path:path,update:t,onComplete:n,status:null,order:S(),applyLocally:o,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Ni(e,path,void 0);c.currentInputSnapshot=h;const d=c.update(h.val());if(void 0===d)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{ti("transaction failed: Data returned ",d,c.path),c.status=0;const t=$r(e.transactionQueueTree_,path),n=qr(t)||[];let r;n.push(c),Br(t,n),"object"==typeof d&&null!==d&&Object(l.l)(d,".priority")?(r=Object(l.O)(d,".priority"),Object(l.f)(Zr(r),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):r=(mr(e.serverSyncTree_,path)||gt.EMPTY_NODE).getPriority().val();const o=wi(e),f=vt(d,r),_=Fr(f,h,o);c.currentOutputSnapshotRaw=f,c.currentOutputSnapshotResolved=_,c.currentWriteId=xi(e);const m=cr(e.serverSyncTree_,path,_,c.currentWriteId,c.applyLocally);pi(e.eventQueue_,path,m),Ri(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let o=null;t?c.reject(t):(o=new ts(r,new es(e._repo,e._path),at),c.resolve(new oo(n,o)))}),h,o),c.promise}Be.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Be.prototype.echo=function(data,e){this.sendRequest("echo",{d:data},e)};var lo;_(r.SDK_VERSION),Object(r._registerComponent)(new o.a("database",((e,{instanceIdentifier:t})=>Ks(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Object(r.registerVersion)(h,d,lo),Object(r.registerVersion)(h,d,"esm2017")}).call(this,n(30))},839:function(e,t,n){"use strict";n.r(t);var r=n(803),o=n(802),l=n(835),c=n(801),h=n(807);const d=new h.b("@firebase/database-compat"),f=function(e){const t="FIREBASE WARNING: "+e;d.warn(t)};class _{constructor(e){this._delegate=e}cancel(e){Object(c.S)("OnDisconnect.cancel",0,1,arguments.length),Object(c.T)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){Object(c.S)("OnDisconnect.remove",0,1,arguments.length),Object(c.T)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){Object(c.S)("OnDisconnect.set",1,2,arguments.length),Object(c.T)("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){Object(c.S)("OnDisconnect.setWithPriority",2,3,arguments.length),Object(c.T)("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(Object(c.S)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let i=0;i<e.length;++i)t[""+i]=e[i];e=t,f("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(c.T)("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}class m{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Object(c.S)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class v{constructor(e,t){this._database=e,this._delegate=t}val(){return Object(c.S)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Object(c.S)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Object(c.S)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Object(c.S)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(path){return Object(c.S)("DataSnapshot.child",0,1,arguments.length),path=String(path),Object(l.g)("DataSnapshot.child","path",path,!1),new v(this._database,this._delegate.child(path))}hasChild(path){return Object(c.S)("DataSnapshot.hasChild",1,1,arguments.length),Object(l.g)("DataSnapshot.hasChild","path",path,!1),this._delegate.hasChild(path)}getPriority(){return Object(c.S)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Object(c.S)("DataSnapshot.forEach",1,1,arguments.length),Object(c.T)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new v(this._database,t))))}hasChildren(){return Object(c.S)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Object(c.S)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Object(c.S)("DataSnapshot.ref",0,0,arguments.length),new w(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class y{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var o;Object(c.S)("Query.on",2,4,arguments.length),Object(c.T)("Query.on","callback",t,!1);const h=y.getCancelAndContextArgs_("Query.on",n,r),d=(e,n)=>{t.call(h.context,new v(this.database,e),n)};d.userCallback=t,d.context=h.context;const f=null===(o=h.cancel)||void 0===o?void 0:o.bind(h.context);switch(e){case"value":return Object(l.B)(this._delegate,d,f),t;case"child_added":return Object(l.x)(this._delegate,d,f),t;case"child_removed":return Object(l.A)(this._delegate,d,f),t;case"child_changed":return Object(l.y)(this._delegate,d,f),t;case"child_moved":return Object(l.z)(this._delegate,d,f),t;default:throw new Error(Object(c.r)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(Object(c.S)("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(c.r)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),Object(c.T)("Query.off","callback",t,!0),Object(c.U)("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,Object(l.w)(this._delegate,e,r)}else Object(l.w)(this._delegate,e)}get(){return Object(l.q)(this._delegate).then((e=>new v(this.database,e)))}once(e,t,n,r){Object(c.S)("Query.once",1,4,arguments.length),Object(c.T)("Query.once","callback",t,!0);const o=y.getCancelAndContextArgs_("Query.once",n,r),h=new c.a,d=(e,n)=>{const r=new v(this.database,e);t&&t.call(o.context,r,n),h.resolve(r)};d.userCallback=t,d.context=o.context;const f=e=>{o.cancel&&o.cancel.call(o.context,e),h.reject(e)};switch(e){case"value":Object(l.B)(this._delegate,d,f,{onlyOnce:!0});break;case"child_added":Object(l.x)(this._delegate,d,f,{onlyOnce:!0});break;case"child_removed":Object(l.A)(this._delegate,d,f,{onlyOnce:!0});break;case"child_changed":Object(l.y)(this._delegate,d,f,{onlyOnce:!0});break;case"child_moved":Object(l.z)(this._delegate,d,f,{onlyOnce:!0});break;default:throw new Error(Object(c.r)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return h.promise}limitToFirst(e){return Object(c.S)("Query.limitToFirst",1,1,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.u)(e)))}limitToLast(e){return Object(c.S)("Query.limitToLast",1,1,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.v)(e)))}orderByChild(path){return Object(c.S)("Query.orderByChild",1,1,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.C)(path)))}orderByKey(){return Object(c.S)("Query.orderByKey",0,0,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.D)()))}orderByPriority(){return Object(c.S)("Query.orderByPriority",0,0,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.E)()))}orderByValue(){return Object(c.S)("Query.orderByValue",0,0,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.F)()))}startAt(e=null,t){return Object(c.S)("Query.startAt",0,2,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.R)(e,t)))}startAfter(e=null,t){return Object(c.S)("Query.startAfter",0,2,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.Q)(e,t)))}endAt(e=null,t){return Object(c.S)("Query.endAt",0,2,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.l)(e,t)))}endBefore(e=null,t){return Object(c.S)("Query.endBefore",0,2,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.m)(e,t)))}equalTo(e,t){return Object(c.S)("Query.equalTo",1,2,arguments.length),new y(this.database,Object(l.H)(this._delegate,Object(l.n)(e,t)))}toString(){return Object(c.S)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Object(c.S)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Object(c.S)("Query.isEqual",1,1,arguments.length),!(e instanceof y)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Object(c.T)(e,"cancel",r.cancel,!0),r.context=n,Object(c.U)(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Object(c.r)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new w(this.database,new l.d(this._delegate._repo,this._delegate._path))}}class w extends y{constructor(e,t){super(e,new l.b(t._repo,t._path,new l.c,!1)),this.database=e,this._delegate=t}getKey(){return Object(c.S)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Object(c.S)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new w(this.database,Object(l.i)(this._delegate,e))}getParent(){Object(c.S)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new w(this.database,e):null}getRoot(){return Object(c.S)("Reference.root",0,0,arguments.length),new w(this.database,this._delegate.root)}set(e,t){Object(c.S)("Reference.set",1,2,arguments.length),Object(c.T)("Reference.set","onComplete",t,!0);const n=Object(l.N)(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(Object(c.S)("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let i=0;i<e.length;++i)t[""+i]=e[i];e=t,f("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(l.h)("Reference.update",this._delegate._path),Object(c.T)("Reference.update","onComplete",t,!0);const n=Object(l.S)(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){Object(c.S)("Reference.setWithPriority",2,3,arguments.length),Object(c.T)("Reference.setWithPriority","onComplete",n,!0);const r=Object(l.P)(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){Object(c.S)("Reference.remove",0,1,arguments.length),Object(c.T)("Reference.remove","onComplete",e,!0);const t=Object(l.K)(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){Object(c.S)("Reference.transaction",1,3,arguments.length),Object(c.T)("Reference.transaction","transactionUpdate",e,!1),Object(c.T)("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(c.r)(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=Object(l.L)(this._delegate,e,{applyLocally:n}).then((e=>new m(e.committed,new v(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){Object(c.S)("Reference.setPriority",1,2,arguments.length),Object(c.T)("Reference.setPriority","onComplete",t,!0);const n=Object(l.O)(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){Object(c.S)("Reference.push",0,2,arguments.length),Object(c.T)("Reference.push","onComplete",t,!0);const n=Object(l.G)(this._delegate,e),r=n.then((e=>new w(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const o=new w(this.database,n);return o.then=r.then.bind(r),o.catch=r.catch.bind(r,void 0),o}onDisconnect(){return Object(l.h)("Reference.onDisconnect",this._delegate._path),new _(new l.a(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class O{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:l.p,forceLongPolling:l.o}}useEmulator(e,t,n={}){Object(l.j)(this._delegate,e,t,n)}ref(path){if(Object(c.S)("database.ref",0,1,arguments.length),path instanceof w){const e=Object(l.J)(this._delegate,path.toString());return new w(this,e)}{const e=Object(l.I)(this._delegate,path);return new w(this,e)}}refFromURL(e){Object(c.S)("database.refFromURL",1,1,arguments.length);const t=Object(l.J)(this._delegate,e);return new w(this,t)}goOffline(){return Object(c.S)("database.goOffline",0,0,arguments.length),Object(l.r)(this._delegate)}goOnline(){return Object(c.S)("database.goOnline",0,0,arguments.length),Object(l.s)(this._delegate)}}O.ServerValue={TIMESTAMP:Object(l.M)(),increment:e=>Object(l.t)(e)};var C=Object.freeze({__proto__:null,initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,namespace:c,nodeAdmin:h=!1}){Object(l.f)(n);const d=new o.c("auth-internal",new o.b("database-standalone"));return d.setComponent(new o.a("auth-internal",(()=>r),"PRIVATE")),{instance:new O(Object(l.e)(e,d,void 0,t,h),e),namespace:c}}});const S=O.ServerValue;var x;(x=r.a).INTERNAL.registerComponent(new o.a("database-compat",((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new O(r,n)}),"PUBLIC").setServiceProps({Reference:w,Query:y,Database:O,DataSnapshot:v,enableLogging:l.k,INTERNAL:C,ServerValue:S}).setMultipleInstances(!0)),x.registerVersion("@firebase/database-compat","0.3.4")},845:function(e,t,n){var content=n(870);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("30726de9",content,!0,{sourceMap:!1})},848:function(e,t,n){"use strict";var r=n(24),o=n(20),l=n(1),c=(n(33),n(9),n(10),n(180),n(305),n(80),n(73),n(464),n(230),n(45),n(23),n(15),n(16),n(12),n(3),n(35),n(92),n(11),n(813),n(91)),h=(n(54),n(29),n(306),n(0)),d=n(2);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=d.a.extend({name:"v-data",inheritAttrs:!1,props:{items:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){return{}}},sortBy:{type:[String,Array]},sortDesc:{type:[Boolean,Array]},customSort:{type:Function,default:h.C},mustSort:Boolean,multiSort:Boolean,page:{type:Number,default:1},itemsPerPage:{type:Number,default:10},groupBy:{type:[String,Array],default:function(){return[]}},groupDesc:{type:[Boolean,Array],default:function(){return[]}},customGroup:{type:Function,default:h.u},locale:{type:String,default:"en-US"},disableSort:Boolean,disablePagination:Boolean,disableFiltering:Boolean,search:String,customFilter:{type:Function,default:h.B},serverItemsLength:{type:Number,default:-1}},data:function(){var e={page:this.page,itemsPerPage:this.itemsPerPage,sortBy:Object(h.E)(this.sortBy),sortDesc:Object(h.E)(this.sortDesc),groupBy:Object(h.E)(this.groupBy),groupDesc:Object(h.E)(this.groupDesc),mustSort:this.mustSort,multiSort:this.multiSort};this.options&&(e=Object.assign(e,this.options));var t,n,r=e,o=r.sortBy,l=r.sortDesc,d=r.groupBy,f=r.groupDesc,_=o.length-l.length,m=d.length-f.length;_>0&&(t=e.sortDesc).push.apply(t,Object(c.a)(Object(h.l)(_,!1)));m>0&&(n=e.groupDesc).push.apply(n,Object(c.a)(Object(h.l)(m,!1)));return{internalOptions:e}},computed:{itemsLength:function(){return this.serverItemsLength>=0?this.serverItemsLength:this.filteredItems.length},pageCount:function(){return this.internalOptions.itemsPerPage<=0?1:Math.ceil(this.itemsLength/this.internalOptions.itemsPerPage)},pageStart:function(){return-1!==this.internalOptions.itemsPerPage&&this.items.length?(this.internalOptions.page-1)*this.internalOptions.itemsPerPage:0},pageStop:function(){return-1===this.internalOptions.itemsPerPage?this.itemsLength:this.items.length?Math.min(this.itemsLength,this.internalOptions.page*this.internalOptions.itemsPerPage):0},isGrouped:function(){return!!this.internalOptions.groupBy.length},pagination:function(){return{page:this.internalOptions.page,itemsPerPage:this.internalOptions.itemsPerPage,pageStart:this.pageStart,pageStop:this.pageStop,pageCount:this.pageCount,itemsLength:this.itemsLength}},filteredItems:function(){var e=this.items.slice();return!this.disableFiltering&&this.serverItemsLength<=0&&(e=this.customFilter(e,this.search)),e},computedItems:function(){var e=this.filteredItems.slice();return(!this.disableSort||this.internalOptions.groupBy.length)&&this.serverItemsLength<=0&&(e=this.sortItems(e)),!this.disablePagination&&this.serverItemsLength<=0&&(e=this.paginateItems(e)),e},groupedItems:function(){return this.isGrouped?this.groupItems(this.computedItems):null},scopedProps:function(){return{sort:this.sort,sortArray:this.sortArray,group:this.group,items:this.computedItems,options:this.internalOptions,updateOptions:this.updateOptions,pagination:this.pagination,groupedItems:this.groupedItems,originalItemsLength:this.items.length}},computedOptions:function(){return _({},this.options)}},watch:{computedOptions:{handler:function(e,t){Object(h.j)(e,t)||this.updateOptions(e)},deep:!0,immediate:!0},internalOptions:{handler:function(e,t){Object(h.j)(e,t)||this.$emit("update:options",e)},deep:!0,immediate:!0},page:function(e){this.updateOptions({page:e})},"internalOptions.page":function(e){this.$emit("update:page",e)},itemsPerPage:function(e){this.updateOptions({itemsPerPage:e})},"internalOptions.itemsPerPage":function(e){this.$emit("update:items-per-page",e)},sortBy:function(e){this.updateOptions({sortBy:Object(h.E)(e)})},"internalOptions.sortBy":function(e,t){!Object(h.j)(e,t)&&this.$emit("update:sort-by",Array.isArray(this.sortBy)?e:e[0])},sortDesc:function(e){this.updateOptions({sortDesc:Object(h.E)(e)})},"internalOptions.sortDesc":function(e,t){!Object(h.j)(e,t)&&this.$emit("update:sort-desc",Array.isArray(this.sortDesc)?e:e[0])},groupBy:function(e){this.updateOptions({groupBy:Object(h.E)(e)})},"internalOptions.groupBy":function(e,t){!Object(h.j)(e,t)&&this.$emit("update:group-by",Array.isArray(this.groupBy)?e:e[0])},groupDesc:function(e){this.updateOptions({groupDesc:Object(h.E)(e)})},"internalOptions.groupDesc":function(e,t){!Object(h.j)(e,t)&&this.$emit("update:group-desc",Array.isArray(this.groupDesc)?e:e[0])},multiSort:function(e){this.updateOptions({multiSort:e})},"internalOptions.multiSort":function(e){this.$emit("update:multi-sort",e)},mustSort:function(e){this.updateOptions({mustSort:e})},"internalOptions.mustSort":function(e){this.$emit("update:must-sort",e)},pageCount:{handler:function(e){this.$emit("page-count",e)},immediate:!0},computedItems:{handler:function(e){this.$emit("current-items",e)},immediate:!0},pagination:{handler:function(e,t){Object(h.j)(e,t)||this.$emit("pagination",this.pagination)},immediate:!0}},methods:{toggle:function(e,t,n,r,o,l){var c=t.slice(),desc=n.slice(),d=c.findIndex((function(t){return t===e}));return d<0?(l||(c=[],desc=[]),c.push(e),desc.push(!1)):d>=0&&!desc[d]?desc[d]=!0:o?desc[d]=!1:(c.splice(d,1),desc.splice(d,1)),Object(h.j)(c,t)&&Object(h.j)(desc,n)||(r=1),{by:c,desc:desc,page:r}},group:function(e){var t=this.toggle(e,this.internalOptions.groupBy,this.internalOptions.groupDesc,this.internalOptions.page,!0,!1),n=t.by,r=t.desc,o=t.page;this.updateOptions({groupBy:n,groupDesc:r,page:o})},sort:function(e){if(Array.isArray(e))return this.sortArray(e);var t=this.toggle(e,this.internalOptions.sortBy,this.internalOptions.sortDesc,this.internalOptions.page,this.internalOptions.mustSort,this.internalOptions.multiSort),n=t.by,r=t.desc,o=t.page;this.updateOptions({sortBy:n,sortDesc:r,page:o})},sortArray:function(e){var t=this,n=e.map((function(s){var i=t.internalOptions.sortBy.findIndex((function(e){return e===s}));return i>-1&&t.internalOptions.sortDesc[i]}));this.updateOptions({sortBy:e,sortDesc:n})},updateOptions:function(e){this.internalOptions=_(_(_({},this.internalOptions),e),{},{page:this.serverItemsLength<0?Math.max(1,Math.min(e.page||this.internalOptions.page,this.pageCount)):e.page||this.internalOptions.page})},sortItems:function(e){var t=[],n=[];return this.disableSort||(t=this.internalOptions.sortBy,n=this.internalOptions.sortDesc),this.internalOptions.groupBy.length&&(t=[].concat(Object(c.a)(this.internalOptions.groupBy),Object(c.a)(t)),n=[].concat(Object(c.a)(this.internalOptions.groupDesc),Object(c.a)(n))),this.customSort(e,t,n,this.locale)},groupItems:function(e){return this.customGroup(e,this.internalOptions.groupBy,this.internalOptions.groupDesc)},paginateItems:function(e){return-1===this.serverItemsLength&&e.length<=this.pageStart&&(this.internalOptions.page=Math.max(1,Math.ceil(e.length/this.internalOptions.itemsPerPage))||1),e.slice(this.pageStart,this.pageStop)}},render:function(){return this.$scopedSlots.default&&this.$scopedSlots.default(this.scopedProps)}}),v=(n(48),n(231),n(79),n(46),n(815),n(809)),y=n(113),w=n(463),O=d.a.extend({name:"v-data-footer",props:{options:{type:Object,required:!0},pagination:{type:Object,required:!0},itemsPerPageOptions:{type:Array,default:function(){return[5,10,15,-1]}},prevIcon:{type:String,default:"$prev"},nextIcon:{type:String,default:"$next"},firstIcon:{type:String,default:"$first"},lastIcon:{type:String,default:"$last"},itemsPerPageText:{type:String,default:"$vuetify.dataFooter.itemsPerPageText"},itemsPerPageAllText:{type:String,default:"$vuetify.dataFooter.itemsPerPageAll"},showFirstLastPage:Boolean,showCurrentPage:Boolean,disablePagination:Boolean,disableItemsPerPage:Boolean,pageText:{type:String,default:"$vuetify.dataFooter.pageText"}},computed:{disableNextPageIcon:function(){return this.options.itemsPerPage<=0||this.options.page*this.options.itemsPerPage>=this.pagination.itemsLength||this.pagination.pageStop<0},computedDataItemsPerPageOptions:function(){var e=this;return this.itemsPerPageOptions.map((function(option){return"object"===Object(o.a)(option)?option:e.genDataItemsPerPageOption(option)}))}},methods:{updateOptions:function(e){this.$emit("update:options",Object.assign({},this.options,e))},onFirstPage:function(){this.updateOptions({page:1})},onPreviousPage:function(){this.updateOptions({page:this.options.page-1})},onNextPage:function(){this.updateOptions({page:this.options.page+1})},onLastPage:function(){this.updateOptions({page:this.pagination.pageCount})},onChangeItemsPerPage:function(e){this.updateOptions({itemsPerPage:e,page:1})},genDataItemsPerPageOption:function(option){return{text:-1===option?this.$vuetify.lang.t(this.itemsPerPageAllText):String(option),value:option}},genItemsPerPageSelect:function(){var e=this.options.itemsPerPage,t=this.computedDataItemsPerPageOptions;return t.length<=1?null:(t.find((function(t){return t.value===e}))||(e=t[0]),this.$createElement("div",{staticClass:"v-data-footer__select"},[this.$vuetify.lang.t(this.itemsPerPageText),this.$createElement(v.a,{attrs:{"aria-label":this.$vuetify.lang.t(this.itemsPerPageText)},props:{disabled:this.disableItemsPerPage,items:t,value:e,hideDetails:!0,auto:!0,minWidth:"75px"},on:{input:this.onChangeItemsPerPage}})]))},genPaginationInfo:function(){var e=[""],t=this.pagination.itemsLength,n=this.pagination.pageStart,r=this.pagination.pageStop;return this.pagination.itemsLength&&this.pagination.itemsPerPage?(n=this.pagination.pageStart+1,r=t<this.pagination.pageStop||this.pagination.pageStop<0?t:this.pagination.pageStop,e=this.$scopedSlots["page-text"]?[this.$scopedSlots["page-text"]({pageStart:n,pageStop:r,itemsLength:t})]:[this.$vuetify.lang.t(this.pageText,n,r,t)]):this.$scopedSlots["page-text"]&&(e=[this.$scopedSlots["page-text"]({pageStart:n,pageStop:r,itemsLength:t})]),this.$createElement("div",{class:"v-data-footer__pagination"},e)},genIcon:function(e,t,label,n){return this.$createElement(w.a,{props:{disabled:t||this.disablePagination,icon:!0,text:!0},on:{click:e},attrs:{"aria-label":label}},[this.$createElement(y.a,n)])},genIcons:function(){var e=[],t=[];return e.push(this.genIcon(this.onPreviousPage,1===this.options.page,this.$vuetify.lang.t("$vuetify.dataFooter.prevPage"),this.$vuetify.rtl?this.nextIcon:this.prevIcon)),t.push(this.genIcon(this.onNextPage,this.disableNextPageIcon,this.$vuetify.lang.t("$vuetify.dataFooter.nextPage"),this.$vuetify.rtl?this.prevIcon:this.nextIcon)),this.showFirstLastPage&&(e.unshift(this.genIcon(this.onFirstPage,1===this.options.page,this.$vuetify.lang.t("$vuetify.dataFooter.firstPage"),this.$vuetify.rtl?this.lastIcon:this.firstIcon)),t.push(this.genIcon(this.onLastPage,this.options.page>=this.pagination.pageCount||-1===this.options.itemsPerPage,this.$vuetify.lang.t("$vuetify.dataFooter.lastPage"),this.$vuetify.rtl?this.firstIcon:this.lastIcon))),[this.$createElement("div",{staticClass:"v-data-footer__icons-before"},e),this.showCurrentPage&&this.$createElement("span",[this.options.page.toString()]),this.$createElement("div",{staticClass:"v-data-footer__icons-after"},t)]}},render:function(){return this.$createElement("div",{staticClass:"v-data-footer"},[Object(h.r)(this,"prepend"),this.genItemsPerPageSelect(),this.genPaginationInfo(),this.genIcons()])}}),C=n(233),S=n(25),x=n(5),k=n(8);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=Object(x.a)(C.a,S.a).extend({name:"v-data-iterator",props:P(P({},m.options.props),{},{itemKey:{type:String,default:"id"},value:{type:Array,default:function(){return[]}},singleSelect:Boolean,expanded:{type:Array,default:function(){return[]}},mobileBreakpoint:P(P({},C.a.options.props.mobileBreakpoint),{},{default:600}),singleExpand:Boolean,loading:[Boolean,String],noResultsText:{type:String,default:"$vuetify.dataIterator.noResultsText"},noDataText:{type:String,default:"$vuetify.noDataText"},loadingText:{type:String,default:"$vuetify.dataIterator.loadingText"},hideDefaultFooter:Boolean,footerProps:Object,selectableKey:{type:String,default:"isSelectable"}}),data:function(){return{selection:{},expansion:{},internalCurrentItems:[],shiftKeyDown:!1,lastEntry:-1}},computed:{everyItem:function(){var e=this;return!!this.selectableItems.length&&this.selectableItems.every((function(i){return e.isSelected(i)}))},someItems:function(){var e=this;return this.selectableItems.some((function(i){return e.isSelected(i)}))},sanitizedFooterProps:function(){return Object(h.d)(this.footerProps)},selectableItems:function(){var e=this;return this.internalCurrentItems.filter((function(t){return e.isSelectable(t)}))}},watch:{value:{handler:function(e){var t=this;this.selection=e.reduce((function(e,n){return e[Object(h.o)(n,t.itemKey)]=n,e}),{})},immediate:!0},selection:function(e,t){Object(h.j)(Object.keys(e),Object.keys(t))||this.$emit("input",Object.values(e))},expanded:{handler:function(e){var t=this;this.expansion=e.reduce((function(e,n){return e[Object(h.o)(n,t.itemKey)]=!0,e}),{})},immediate:!0},expansion:function(e,t){var n=this;if(!Object(h.j)(e,t)){var r=Object.keys(e).filter((function(t){return e[t]})),o=r.length?this.items.filter((function(i){return r.includes(String(Object(h.o)(i,n.itemKey)))})):[];this.$emit("update:expanded",o)}}},created:function(){var e=this;[["disable-initial-sort","sort-by"],["filter","custom-filter"],["pagination","options"],["total-items","server-items-length"],["hide-actions","hide-default-footer"],["rows-per-page-items","footer-props.items-per-page-options"],["rows-per-page-text","footer-props.items-per-page-text"],["prev-icon","footer-props.prev-icon"],["next-icon","footer-props.next-icon"]].forEach((function(t){var n=Object(r.a)(t,2),o=n[0],l=n[1];e.$attrs.hasOwnProperty(o)&&Object(k.a)(o,l,e)}));["expand","content-class","content-props","content-tag"].forEach((function(t){e.$attrs.hasOwnProperty(t)&&Object(k.e)(t)}))},mounted:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},beforeDestroy:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},methods:{onKeyDown:function(e){this.shiftKeyDown=e.keyCode===h.w.shift||e.shiftKey},onKeyUp:function(e){e.keyCode!==h.w.shift&&e.shiftKey||(this.shiftKeyDown=!1)},toggleSelectAll:function(e){for(var t=Object.assign({},this.selection),i=0;i<this.selectableItems.length;i++){var n=this.selectableItems[i];if(this.isSelectable(n)){var r=Object(h.o)(n,this.itemKey);e?t[r]=n:delete t[r]}}this.selection=t,this.$emit("toggle-select-all",{items:this.internalCurrentItems,value:e})},isSelectable:function(e){return!1!==Object(h.o)(e,this.selectableKey)},isSelected:function(e){return!!this.selection[Object(h.o)(e,this.itemKey)]||!1},select:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isSelectable(e)){var o=this.singleSelect?{}:Object.assign({},this.selection),l=Object(h.o)(e,this.itemKey);n?o[l]=e:delete o[l];var c=this.selectableItems.findIndex((function(e){return Object(h.o)(e,t.itemKey)===l}));if(-1===this.lastEntry)this.lastEntry=c;else if(this.shiftKeyDown&&!this.singleSelect&&r){var d=Object(h.o)(this.selectableItems[this.lastEntry],this.itemKey),f=Object.keys(this.selection).includes(String(d));this.multipleSelect(f,r,o,c)}if(this.lastEntry=c,this.singleSelect&&r){var _=Object.keys(this.selection),m=_.length&&Object(h.o)(this.selection[_[0]],this.itemKey);m&&m!==l&&this.$emit("item-selected",{item:this.selection[m],value:!1})}this.selection=o,r&&this.$emit("item-selected",{item:e,value:n})}},multipleSelect:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=r<this.lastEntry?r:this.lastEntry,l=r<this.lastEntry?this.lastEntry:r,i=o;i<=l;i++){var c=this.selectableItems[i],d=Object(h.o)(c,this.itemKey);e?n[d]=c:delete n[d],t&&this.$emit("item-selected",{currentItem:c,value:e})}},isExpanded:function(e){return this.expansion[Object(h.o)(e,this.itemKey)]||!1},expand:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.singleExpand?{}:Object.assign({},this.expansion),r=Object(h.o)(e,this.itemKey);t?n[r]=!0:delete n[r],this.expansion=n,this.$emit("item-expanded",{item:e,value:t})},createItemProps:function(e,t){var n=this;return{item:e,index:t,select:function(t){return n.select(e,t)},isSelected:this.isSelected(e),expand:function(t){return n.expand(e,t)},isExpanded:this.isExpanded(e),isMobile:this.isMobile}},genEmptyWrapper:function(content){return this.$createElement("div",content)},genEmpty:function(e,t){if(0===e&&this.loading){var n=this.$slots.loading||this.$vuetify.lang.t(this.loadingText);return this.genEmptyWrapper(n)}if(0===e){var r=this.$slots["no-data"]||this.$vuetify.lang.t(this.noDataText);return this.genEmptyWrapper(r)}if(0===t){var o=this.$slots["no-results"]||this.$vuetify.lang.t(this.noResultsText);return this.genEmptyWrapper(o)}return null},genItems:function(e){var t=this,n=this.genEmpty(e.originalItemsLength,e.pagination.itemsLength);return n?[n]:this.$scopedSlots.default?this.$scopedSlots.default(P(P({},e),{},{isSelected:this.isSelected,select:this.select,isExpanded:this.isExpanded,isMobile:this.isMobile,expand:this.expand})):this.$scopedSlots.item?e.items.map((function(e,n){return t.$scopedSlots.item(t.createItemProps(e,n))})):[]},genFooter:function(e){if(this.hideDefaultFooter)return null;var data={props:P(P({},this.sanitizedFooterProps),{},{options:e.options,pagination:e.pagination}),on:{"update:options":function(t){return e.updateOptions(t)}}},t=Object(h.p)("footer.",this.$scopedSlots);return this.$createElement(O,P({scopedSlots:t},data))},genDefaultScopedSlot:function(e){var t=P(P({},e),{},{someItems:this.someItems,everyItem:this.everyItem,toggleSelectAll:this.toggleSelectAll});return this.$createElement("div",{staticClass:"v-data-iterator"},[Object(h.r)(this,"header",t,!0),this.genItems(e),this.genFooter(e),Object(h.r)(this,"footer",t,!0)])}},render:function(){var e=this;return this.$createElement(m,{props:this.$props,on:{"update:options":function(t,n){return!Object(h.j)(t,n)&&e.$emit("update:options",t)},"update:page":function(t){return e.$emit("update:page",t)},"update:items-per-page":function(t){return e.$emit("update:items-per-page",t)},"update:sort-by":function(t){return e.$emit("update:sort-by",t)},"update:sort-desc":function(t){return e.$emit("update:sort-desc",t)},"update:group-by":function(t){return e.$emit("update:group-by",t)},"update:group-desc":function(t){return e.$emit("update:group-desc",t)},pagination:function(t,n){return!Object(h.j)(t,n)&&e.$emit("pagination",t)},"current-items":function(t){e.internalCurrentItems=t,e.$emit("current-items",t)},"page-count":function(t){return e.$emit("page-count",t)}},scopedSlots:{default:this.genDefaultScopedSlot}})}}),j=(n(817),n(825)),E=n(808),D=n(82);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var R=Object(x.a)().extend({directives:{ripple:D.a},props:{headers:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){return{page:1,itemsPerPage:10,sortBy:[],sortDesc:[],groupBy:[],groupDesc:[],multiSort:!1,mustSort:!1}}},checkboxColor:String,sortIcon:{type:String,default:"$sort"},everyItem:Boolean,someItems:Boolean,showGroupBy:Boolean,singleSelect:Boolean,disableSort:Boolean},methods:{genSelectAll:function(){var e,t=this,data={props:{value:this.everyItem,indeterminate:!this.everyItem&&this.someItems,color:null!==(e=this.checkboxColor)&&void 0!==e?e:""},on:{input:function(e){return t.$emit("toggle-select-all",e)}}};return this.$scopedSlots["data-table-select"]?this.$scopedSlots["data-table-select"](data):this.$createElement(E.a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({staticClass:"v-data-table__checkbox"},data))},genSortIcon:function(){return this.$createElement(y.a,{staticClass:"v-data-table-header__icon",props:{size:18}},[this.sortIcon])}}}),M=Object(x.a)(R).extend({name:"v-data-table-header-mobile",props:{sortByText:{type:String,default:"$vuetify.dataTable.sortBy"}},methods:{genSortChip:function(e){var t=this,n=[e.item.text],r=this.options.sortBy.findIndex((function(t){return t===e.item.value})),o=r>=0,l=this.options.sortDesc[r];return n.push(this.$createElement("div",{staticClass:"v-chip__close",class:{sortable:!0,active:o,asc:o&&!l,desc:o&&l}},[this.genSortIcon()])),this.$createElement(j.a,{staticClass:"sortable",on:{click:function(n){n.stopPropagation(),t.$emit("sort",e.item.value)}}},n)},genSortSelect:function(e){var t=this;return this.$createElement(v.a,{props:{label:this.$vuetify.lang.t(this.sortByText),items:e,hideDetails:!0,multiple:this.options.multiSort,value:this.options.multiSort?this.options.sortBy:this.options.sortBy[0],menuProps:{closeOnContentClick:!0}},on:{change:function(e){return t.$emit("sort",e)}},scopedSlots:{selection:function(e){return t.genSortChip(e)}}})}},render:function(e){var t=[],header=this.headers.find((function(e){return"data-table-select"===e.value}));header&&!this.singleSelect&&t.push(this.$createElement("div",{class:["v-data-table-header-mobile__select"].concat(Object(c.a)(Object(h.E)(header.class))),attrs:{width:header.width}},[this.genSelectAll()]));var n=this.headers.filter((function(e){return!1!==e.sortable&&"data-table-select"!==e.value})).map((function(e){return{text:e.text,value:e.value}}));!this.disableSort&&n.length&&t.push(this.genSortSelect(n));var th=t.length?e("th",[e("div",{staticClass:"v-data-table-header-mobile__wrapper"},t)]):void 0,tr=e("tr",[th]);return e("thead",{staticClass:"v-data-table-header v-data-table-header-mobile"},[tr])}}),A=(n(114),Object(x.a)(R).extend({name:"v-data-table-header-desktop",methods:{genGroupByToggle:function(header){var e=this;return this.$createElement("span",{on:{click:function(t){t.stopPropagation(),e.$emit("group",header.value)}}},["group"])},getAria:function(e,t){var n=this,r=function(e){return n.$vuetify.lang.t("$vuetify.dataTable.ariaLabel.".concat(e))},o="none",l=[r("sortNone"),r("activateAscending")];return e?(t?(o="descending",l=[r("sortDescending"),r(this.options.mustSort?"activateAscending":"activateNone")]):(o="ascending",l=[r("sortAscending"),r("activateDescending")]),{ariaSort:o,ariaLabel:l.join(" ")}):{ariaSort:o,ariaLabel:l.join(" ")}},genHeader:function(header){var e=this,data={attrs:{role:"columnheader",scope:"col","aria-label":header.text||""},style:{width:Object(h.h)(header.width),minWidth:Object(h.h)(header.width)},class:["text-".concat(header.align||"start")].concat(Object(c.a)(Object(h.E)(header.class)),[header.divider&&"v-data-table__divider"]),on:{}},t=[];if("data-table-select"===header.value&&!this.singleSelect)return this.$createElement("th",data,[this.genSelectAll()]);if(t.push(this.$scopedSlots.hasOwnProperty(header.value)?this.$scopedSlots[header.value]({header:header}):this.$createElement("span",[header.text])),!this.disableSort&&(header.sortable||!header.hasOwnProperty("sortable"))){data.on.click=function(){return e.$emit("sort",header.value)};var n=this.options.sortBy.findIndex((function(e){return e===header.value})),r=n>=0,o=this.options.sortDesc[n];data.class.push("sortable");var l=this.getAria(r,o),d=l.ariaLabel,f=l.ariaSort;data.attrs["aria-label"]+="".concat(header.text?": ":"").concat(d),data.attrs["aria-sort"]=f,r&&(data.class.push("active"),data.class.push(o?"desc":"asc")),"end"===header.align?t.unshift(this.genSortIcon()):t.push(this.genSortIcon()),this.options.multiSort&&r&&t.push(this.$createElement("span",{class:"v-data-table-header__sort-badge"},[String(n+1)]))}return this.showGroupBy&&!1!==header.groupable&&t.push(this.genGroupByToggle(header)),this.$createElement("th",data,t)}},render:function(){var e=this;return this.$createElement("thead",{staticClass:"v-data-table-header"},[this.$createElement("tr",this.headers.map((function(header){return e.genHeader(header)})))])}}));var F=n(52);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=d.a.extend({name:"v-data-table-header",functional:!0,props:L(L({},R.options.props),{},{mobile:Boolean}),render:function(e,t){var n=t.props,data=t.data,r=t.slots;!function(data){if(data.model&&data.on&&data.on.input)if(Array.isArray(data.on.input)){var i=data.on.input.indexOf(data.model.callback);i>-1&&data.on.input.splice(i,1)}else delete data.on.input}(data);var o=function(e,t){var n=[];for(var slot in e)e.hasOwnProperty(slot)&&n.push(t("template",{slot:slot},e[slot]));return n}(r(),e);return data=Object(F.a)(data,{props:n}),n.mobile?e(M,data,o):e(A,data,o)}});var B=d.a.extend({name:"row",functional:!0,props:{headers:Array,index:Number,item:Object,rtl:Boolean},render:function(e,t){var n=t.props,r=t.slots,data=t.data,o=r(),l=n.headers.map((function(header){var t=[],r=Object(h.o)(n.item,header.value),l=header.value,d=data.scopedSlots&&data.scopedSlots.hasOwnProperty(l)&&data.scopedSlots[l],f=o.hasOwnProperty(l)&&o[l];d?t.push.apply(t,Object(c.a)(Object(h.E)(d({item:n.item,isMobile:!1,header:header,index:n.index,value:r})))):f?t.push.apply(t,Object(c.a)(Object(h.E)(f))):t.push(null==r?r:String(r));var slot,_,m="text-".concat(header.align||"start");return 1===(slot=t).length&&["td","th"].includes(null===(_=slot[0])||void 0===_?void 0:_.tag)?t:e("td",{class:[m,header.cellClass,{"v-data-table__divider":header.divider}]},t)}));return e("tr",data,l)}}),W=d.a.extend({name:"row-group",functional:!0,props:{value:{type:Boolean,default:!0},headerClass:{type:String,default:"v-row-group__header"},contentClass:String,summaryClass:{type:String,default:"v-row-group__summary"}},render:function(e,t){var n=t.slots,r=t.props,o=n(),l=[];return o["column.header"]?l.push(e("tr",{staticClass:r.headerClass},o["column.header"])):o["row.header"]&&l.push.apply(l,Object(c.a)(o["row.header"])),o["row.content"]&&r.value&&l.push.apply(l,Object(c.a)(o["row.content"])),o["column.summary"]?l.push(e("tr",{staticClass:r.summaryClass},o["column.summary"])):o["row.summary"]&&l.push.apply(l,Object(c.a)(o["row.summary"])),l}});n(819);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var z=Object(x.a)(S.a).extend({name:"v-simple-table",props:{dense:Boolean,fixedHeader:Boolean,height:[Number,String]},computed:{classes:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({"v-data-table--dense":this.dense,"v-data-table--fixed-height":!!this.height&&!this.fixedHeader,"v-data-table--fixed-header":this.fixedHeader,"v-data-table--has-top":!!this.$slots.top,"v-data-table--has-bottom":!!this.$slots.bottom},this.themeClasses)}},methods:{genWrapper:function(){return this.$slots.wrapper||this.$createElement("div",{staticClass:"v-data-table__wrapper",style:{height:Object(h.h)(this.height)}},[this.$createElement("table",this.$slots.default)])}},render:function(e){return e("div",{staticClass:"v-data-table",class:this.classes},[this.$slots.top,this.genWrapper(),this.$slots.bottom])}});function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=d.a.extend({name:"row",functional:!0,props:{headers:Array,hideDefaultHeader:Boolean,index:Number,item:Object,rtl:Boolean},render:function(e,t){var n=t.props,r=t.slots,data=t.data,o=r(),l=n.headers.map((function(header){var t=[],r=Object(h.o)(n.item,header.value),l=header.value,c=data.scopedSlots&&data.scopedSlots.hasOwnProperty(l)&&data.scopedSlots[l],d=o.hasOwnProperty(l)&&o[l];c?t.push(c({item:n.item,isMobile:!0,header:header,index:n.index,value:r})):d?t.push(d):t.push(null==r?r:String(r));var f=[e("div",{staticClass:"v-data-table__mobile-row__cell"},t)];return"dataTableSelect"===header.value||n.hideDefaultHeader||f.unshift(e("div",{staticClass:"v-data-table__mobile-row__header"},[header.text])),e("td",{class:{"v-data-table__mobile-row":!0}},f)}));return e("tr",G(G({},data),{},{staticClass:"v-data-table__mobile-table-row"}),l)}}),Q=n(174);n(308),n(309);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=d.a.extend({name:"mouse",methods:{getDefaultMouseEventHandlers:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object.keys(this.$listeners).filter((function(t){return t.endsWith(e)})).reduce((function(t,n){return t[n]={event:n.slice(0,-e.length)},t}),{});return this.getMouseEventHandlers(J(J({},r),{},Object(l.a)({},"contextmenu"+e,{event:"contextmenu",prevent:!0,result:!1})),t,n)},getMouseEventHandlers:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o={},l=function(l){var c=e[l];if(!n.$listeners[l])return 1;var h=(c.passive?"&":(c.once?"~":"")+(c.capture?"!":""))+c.event,d=function(e){var o,h,d=e;if(void 0===c.button||d.buttons>0&&d.button===c.button){if(c.prevent&&e.preventDefault(),c.stop&&e.stopPropagation(),e&&"touches"in e){var f=null===(o=e.currentTarget)||void 0===o?void 0:o.className.split(" "),_=document.elementsFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY).find((function(e){return e.className.split(" ").some((function(e){return f.includes(e)}))}));if(_&&!(null===(h=e.target)||void 0===h?void 0:h.isSameNode(_)))return void _.dispatchEvent(new TouchEvent(e.type,{changedTouches:e.changedTouches,targetTouches:e.targetTouches,touches:e.touches}))}r?n.$emit(l,e,t(e)):n.$emit(l,t(e),e)}return c.result};h in o?Array.isArray(o[h])?o[h].push(d):o[h]=[o[h],d]:o[h]=d};for(var c in e)l(c);return o}}});function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,filter){return function(header){var n=Object(h.o)(e,header.value);return header.filter?header.filter(n,t,e):filter(n,t,e)}}t.a=Object(x.a)(T,Q.a,X).extend({name:"v-data-table",directives:{ripple:D.a},props:{headers:{type:Array,default:function(){return[]}},showSelect:Boolean,checkboxColor:String,showExpand:Boolean,showGroupBy:Boolean,height:[Number,String],hideDefaultHeader:Boolean,caption:String,dense:Boolean,headerProps:Object,calculateWidths:Boolean,fixedHeader:Boolean,headersLength:Number,expandIcon:{type:String,default:"$expand"},customFilter:{type:Function,default:h.k},filterMode:{type:String,default:"intersection"},itemClass:{type:[String,Function],default:function(){return""}},itemStyle:{type:[String,Function],default:function(){return""}},loaderHeight:{type:[Number,String],default:4}},data:function(){return{internalGroupBy:[],openCache:{},widths:[]}},computed:{computedHeaders:function(){var e=this;if(!this.headers)return[];var t=this.headers.filter((function(t){return void 0===t.value||!e.internalGroupBy.find((function(e){return e===t.value}))})),n={text:"",sortable:!1,width:"1px"};if(this.showSelect){var r=t.findIndex((function(e){return"data-table-select"===e.value}));r<0?t.unshift(ee(ee({},n),{},{value:"data-table-select"})):t.splice(r,1,ee(ee({},n),t[r]))}if(this.showExpand){var o=t.findIndex((function(e){return"data-table-expand"===e.value}));o<0?t.unshift(ee(ee({},n),{},{value:"data-table-expand"})):t.splice(o,1,ee(ee({},n),t[o]))}return t},colspanAttrs:function(){return this.isMobile?void 0:{colspan:this.headersLength||this.computedHeaders.length}},columnSorters:function(){return this.computedHeaders.reduce((function(e,header){return header.sort&&(e[header.value]=header.sort),e}),{})},headersWithCustomFilters:function(){return this.headers.filter((function(header){return header.filter&&(!header.hasOwnProperty("filterable")||!0===header.filterable)}))},headersWithoutCustomFilters:function(){return this.headers.filter((function(header){return!(header.filter||header.hasOwnProperty("filterable")&&!0!==header.filterable)}))},sanitizedHeaderProps:function(){return Object(h.d)(this.headerProps)},computedItemsPerPage:function(){var e=this.options&&this.options.itemsPerPage?this.options.itemsPerPage:this.itemsPerPage,t=this.sanitizedFooterProps.itemsPerPageOptions;if(t&&!t.find((function(t){return"number"==typeof t?t===e:t.value===e}))){var n=t[0];return"object"===Object(o.a)(n)?n.value:n}return e},groupByText:function(){var e,t,n,r=this;return null!==(n=null===(t=null===(e=this.headers)||void 0===e?void 0:e.find((function(header){var e;return header.value===(null===(e=r.internalGroupBy)||void 0===e?void 0:e[0])})))||void 0===t?void 0:t.text)&&void 0!==n?n:""}},created:function(){var e=this;[["sort-icon","header-props.sort-icon"],["hide-headers","hide-default-header"],["select-all","show-select"]].forEach((function(t){var n=Object(r.a)(t,2),o=n[0],l=n[1];e.$attrs.hasOwnProperty(o)&&Object(k.a)(o,l,e)}))},mounted:function(){this.calculateWidths&&(window.addEventListener("resize",this.calcWidths),this.calcWidths())},beforeDestroy:function(){this.calculateWidths&&window.removeEventListener("resize",this.calcWidths)},methods:{calcWidths:function(){this.widths=Array.from(this.$el.querySelectorAll("th")).map((function(e){return e.clientWidth}))},customFilterWithColumns:function(e,t){return function(e,t,n,r,o,l){return t="string"==typeof t?t.trim():null,"union"===l?t&&r.length||n.length?e.filter((function(e){return!(!n.length||!n.every(te(e,t,h.k)))||t&&r.some(te(e,t,o))})):e:"intersection"===l?e.filter((function(e){var l=n.every(te(e,t,h.k)),c=!t||r.some(te(e,t,o));return l&&c})):e}(e,t,this.headersWithCustomFilters,this.headersWithoutCustomFilters,this.customFilter,this.filterMode)},customSortWithHeaders:function(e,t,n,r){return this.customSort(e,t,n,r,this.columnSorters)},createItemProps:function(e,t){var n=this,data=ee(ee({},T.options.methods.createItemProps.call(this,e,t)),{},{headers:this.computedHeaders});return ee(ee({},data),{},{attrs:{class:{"v-data-table__selected":data.isSelected}},on:ee(ee({},this.getDefaultMouseEventHandlers(":row",(function(){return data}),!0)),{},{click:function(t){return n.$emit("click:row",e,data,t)}})})},genCaption:function(e){return this.caption?[this.$createElement("caption",[this.caption])]:Object(h.r)(this,"caption",e,!0)},genColgroup:function(e){var t=this;return this.$createElement("colgroup",this.computedHeaders.map((function(header){return t.$createElement("col",{class:{divider:header.divider}})})))},genLoading:function(){var th=this.$createElement("th",{staticClass:"column",attrs:this.colspanAttrs},[this.genProgress()]),tr=this.$createElement("tr",{staticClass:"v-data-table__progress"},[th]);return this.$createElement("thead",[tr])},genHeaders:function(e){var data={props:ee(ee({},this.sanitizedHeaderProps),{},{headers:this.computedHeaders,options:e.options,mobile:this.isMobile,showGroupBy:this.showGroupBy,checkboxColor:this.checkboxColor,someItems:this.someItems,everyItem:this.everyItem,singleSelect:this.singleSelect,disableSort:this.disableSort}),on:{sort:e.sort,group:e.group,"toggle-select-all":this.toggleSelectAll}},t=[Object(h.r)(this,"header",ee(ee({},data),{},{isMobile:this.isMobile}))];if(!this.hideDefaultHeader){var n=Object(h.p)("header.",this.$scopedSlots);t.push(this.$createElement($,ee(ee({},data),{},{scopedSlots:n})))}return this.loading&&t.push(this.genLoading()),t},genEmptyWrapper:function(content){return this.$createElement("tr",{staticClass:"v-data-table__empty-wrapper"},[this.$createElement("td",{attrs:this.colspanAttrs},content)])},genItems:function(e,t){var n=this.genEmpty(t.originalItemsLength,t.pagination.itemsLength);return n?[n]:t.groupedItems?this.genGroupedRows(t.groupedItems,t):this.genRows(e,t)},genGroupedRows:function(e,t){var n=this;return e.map((function(e){return n.openCache.hasOwnProperty(e.name)||n.$set(n.openCache,e.name,!0),n.$scopedSlots.group?n.$scopedSlots.group({group:e.name,options:t.options,isMobile:n.isMobile,items:e.items,headers:n.computedHeaders}):n.genDefaultGroupedRow(e.name,e.items,t)}))},genDefaultGroupedRow:function(e,t,n){var r=this,o=!!this.openCache[e],l=[this.$createElement("template",{slot:"row.content"},this.genRows(t,n))],c=function(){return r.$set(r.openCache,e,!r.openCache[e])},h=function(){return n.updateOptions({groupBy:[],groupDesc:[]})};if(this.$scopedSlots["group.header"])l.unshift(this.$createElement("template",{slot:"column.header"},[this.$scopedSlots["group.header"]({group:e,groupBy:n.options.groupBy,isMobile:this.isMobile,items:t,headers:this.computedHeaders,isOpen:o,toggle:c,remove:h})]));else{var d=this.$createElement(w.a,{staticClass:"ma-0",props:{icon:!0,small:!0},on:{click:c}},[this.$createElement(y.a,[o?"$minus":"$plus"])]),f=this.$createElement(w.a,{staticClass:"ma-0",props:{icon:!0,small:!0},on:{click:h}},[this.$createElement(y.a,["$close"])]),_=this.$createElement("td",{staticClass:"text-start",attrs:this.colspanAttrs},[d,"".concat(this.groupByText,": ").concat(e),f]);l.unshift(this.$createElement("template",{slot:"column.header"},[_]))}return this.$scopedSlots["group.summary"]&&l.push(this.$createElement("template",{slot:"column.summary"},[this.$scopedSlots["group.summary"]({group:e,groupBy:n.options.groupBy,isMobile:this.isMobile,items:t,headers:this.computedHeaders,isOpen:o,toggle:c})])),this.$createElement(W,{key:e,props:{value:o}},l)},genRows:function(e,t){return this.$scopedSlots.item?this.genScopedRows(e,t):this.genDefaultRows(e,t)},genScopedRows:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i];n.push(this.$scopedSlots.item(ee(ee({},this.createItemProps(r,i)),{},{isMobile:this.isMobile}))),this.isExpanded(r)&&n.push(this.$scopedSlots["expanded-item"]({headers:this.computedHeaders,isMobile:this.isMobile,index:i,item:r}))}return n},genDefaultRows:function(e,t){var n=this;return this.$scopedSlots["expanded-item"]?e.map((function(e,t){return n.genDefaultExpandedRow(e,t)})):e.map((function(e,t){return n.genDefaultSimpleRow(e,t)}))},genDefaultExpandedRow:function(e,t){var n=this.isExpanded(e),r={"v-data-table__expanded v-data-table__expanded__row":n},o=this.genDefaultSimpleRow(e,t,r),l=this.$createElement("tr",{staticClass:"v-data-table__expanded v-data-table__expanded__content"},[this.$scopedSlots["expanded-item"]({headers:this.computedHeaders,isMobile:this.isMobile,item:e})]);return this.$createElement(W,{props:{value:n}},[this.$createElement("template",{slot:"row.header"},[o]),this.$createElement("template",{slot:"row.content"},[l])])},genDefaultSimpleRow:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=Object(h.p)("item.",this.$scopedSlots),data=this.createItemProps(e,t);if(this.showSelect){var slot=o["data-table-select"];o["data-table-select"]=slot?function(){return slot(ee(ee({},data),{},{isMobile:n.isMobile}))}:function(){var t;return n.$createElement(E.a,{staticClass:"v-data-table__checkbox",props:{value:data.isSelected,disabled:!n.isSelectable(e),color:null!==(t=n.checkboxColor)&&void 0!==t?t:""},on:{input:function(e){return data.select(e)}}})}}if(this.showExpand){var l=o["data-table-expand"];o["data-table-expand"]=l?function(){return l(data)}:function(){return n.$createElement(y.a,{staticClass:"v-data-table__expand-icon",class:{"v-data-table__expand-icon--active":data.isExpanded},on:{click:function(e){e.stopPropagation(),data.expand(!data.isExpanded)}}},[n.expandIcon])}}return this.$createElement(this.isMobile?K:B,{key:Object(h.o)(e,this.itemKey),class:Object(F.b)(ee(ee({},r),{},{"v-data-table__selected":data.isSelected}),Object(h.q)(e,this.itemClass)),style:Object(F.c)({},Object(h.q)(e,this.itemStyle)),props:{headers:this.computedHeaders,hideDefaultHeader:this.hideDefaultHeader,index:t,item:e,rtl:this.$vuetify.rtl},scopedSlots:o,on:data.on})},genBody:function(e){var data=ee(ee({},e),{},{expand:this.expand,headers:this.computedHeaders,isExpanded:this.isExpanded,isMobile:this.isMobile,isSelected:this.isSelected,select:this.select});return this.$scopedSlots.body?this.$scopedSlots.body(data):this.$createElement("tbody",[Object(h.r)(this,"body.prepend",data,!0),this.genItems(e.items,e),Object(h.r)(this,"body.append",data,!0)])},genFoot:function(e){var t,n;return null===(n=(t=this.$scopedSlots).foot)||void 0===n?void 0:n.call(t,e)},genFooters:function(e){var data={props:ee({options:e.options,pagination:e.pagination,itemsPerPageText:"$vuetify.dataTable.itemsPerPageText"},this.sanitizedFooterProps),on:{"update:options":function(t){return e.updateOptions(t)}},widths:this.widths,headers:this.computedHeaders},t=[Object(h.r)(this,"footer",data,!0)];return this.hideDefaultFooter||t.push(this.$createElement(O,ee(ee({},data),{},{scopedSlots:Object(h.p)("footer.",this.$scopedSlots)}))),t},genDefaultScopedSlot:function(e){var t={height:this.height,fixedHeader:this.fixedHeader,dense:this.dense};return this.$createElement(z,{props:t,class:{"v-data-table--mobile":this.isMobile,"v-data-table--selectable":this.showSelect}},[this.proxySlot("top",Object(h.r)(this,"top",ee(ee({},e),{},{isMobile:this.isMobile}),!0)),this.genCaption(e),this.genColgroup(e),this.genHeaders(e),this.genBody(e),this.genFoot(e),this.proxySlot("bottom",this.genFooters(e))])},proxySlot:function(slot,content){return this.$createElement("template",{slot:slot},content)}},render:function(){var e=this;return this.$createElement(m,{props:ee(ee({},this.$props),{},{customFilter:this.customFilterWithColumns,customSort:this.customSortWithHeaders,itemsPerPage:this.computedItemsPerPage}),on:{"update:options":function(t,n){e.internalGroupBy=t.groupBy||[],!Object(h.j)(t,n)&&e.$emit("update:options",t)},"update:page":function(t){return e.$emit("update:page",t)},"update:items-per-page":function(t){return e.$emit("update:items-per-page",t)},"update:sort-by":function(t){return e.$emit("update:sort-by",t)},"update:sort-desc":function(t){return e.$emit("update:sort-desc",t)},"update:group-by":function(t){return e.$emit("update:group-by",t)},"update:group-desc":function(t){return e.$emit("update:group-desc",t)},pagination:function(t,n){return!Object(h.j)(t,n)&&e.$emit("pagination",t)},"current-items":function(t){e.internalCurrentItems=t,e.$emit("current-items",t)},"page-count":function(t){return e.$emit("page-count",t)}},scopedSlots:{default:this.genDefaultScopedSlot}})}})},851:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(805),o=n(804),l=n(800);function c(e,t){return Object(l.a)(2,arguments),function(e,t){Object(l.a)(2,arguments);var n=Object(o.a)(e),c=Object(r.a)(t);return isNaN(c)?new Date(NaN):c?(n.setDate(n.getDate()+c),n):n}(e,-Object(r.a)(t))}},869:function(e,t,n){"use strict";n(845)},870:function(e,t,n){var r=n(18)((function(i){return i[1]}));r.push([e.i,".bold-center[data-v-281ea13b]{font-weight:700;text-align:center!important}",""]),r.locals={},e.exports=r},882:function(e,t,n){"use strict";n.r(t);var r=n(307),o=n(297),l=n(304),c=n(793),h=n(848),d=n(868),f=n(794),_=n(296),m=n(226),v=n(294),y=n(175),w=n(101),O=n(299),C=n(176),S=n(792),x=n(809),k=n(795),I=n(789),P=n(776),T=(n(45),n(29),n(306),n(21)),j=(n(61),n(33),n(9),n(180),n(48),n(73),n(54),n(3),n(46),n(79),n(832),n(839),n(824)),E=n(851),D=n(879),N=(n(126),n(312)),R=n.n(N),M=n(836),A={computed:{getIDFrontImageUrl:function(){return"".concat(this.server_url,"/uploads/").concat(this.newUser.id,"/").concat(this.newUser.id_front)},getIDBackImageUrl:function(){return"".concat(this.server_url,"/uploads/").concat(this.newUser.id,"/").concat(this.newUser.id_back)},getProfileImageUrl:function(){return"".concat(this.server_url,"/uploads/").concat(this.newUser.id,"/").concat(this.newUser.profile_pic)}},components:{ImageUpload:n(810).default},mounted:function(){var e=this;return Object(T.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=localStorage.getItem("token"),r=localStorage.getItem("serverURL"),o=localStorage.getItem("pots"),n)if(l=R.a.decode(n),console.log(r),l){if(e.currentUser=l,e.userRole=l.role,"Admin"==e.userRole?e.userHasPermission=!0:e.userHasPermission=!1,o){for(c=1;c<parseInt(o)+1;c++)e.potOptions.push(c);console.log(e.potOptions)}else console.log("pots unavailable");r?(e.server_url=r,e.fetchMembers()):(console.log("Invalid setting token."),e.$store.dispatch("auth/logout"))}else console.log("Invalid JWT token."),e.$store.dispatch("auth/logout");else console.log("JWT token not found."),e.$store.dispatch("auth/logout");case 4:case"end":return t.stop()}}),t)})))()},data:function(){return{server_url:null,loadingMore:!1,batch_number:1,snackBarText:"",timeout:2e3,snackbar:!1,depositing:!1,depositingRollNumber:0,totalLottoTogenerate:0,fetching:!1,verifying:!1,UserToDelete:null,UserToVerify:null,phonePrefix:"+251",MembersForVerification:[],displayInfoDialog:!1,depositContributionDialog:!1,userRole:null,currentUser:null,currentUrl:null,currentPhone:null,userHasPermission:!1,generating:!1,loading:!0,minDate:Object(E.a)(new Date,1),searchColumn:"name",User:[],search:"",filteredUser:[],genderOptions:["Male","Female"],potOptions:[],familyRelations:["Adopted Child","Adoptive Parent","Brother","Brother-in-law","Daughter","Daughter-in-law","Father","Father-in-law","Granddaughter","Grandson","Great-Aunt","Great-Granddaughter","Great-Grandfather","Great-Nephew","Great-Niece","Great-Uncle","Husband","Maternal Aunt","Maternal Grandfather","Maternal Grandmother","Maternal Great-Aunt","Maternal Great-Grandfather","Maternal Great-Grandmother","Maternal Great-Uncle","Mother","Mother-in-law","Nephew","Niece","Paternal Aunt","Paternal Cousin","Paternal Grandfather","Paternal Grandmother","Paternal Great-Aunt","Paternal Great-Grandfather","Paternal Great-Grandmother","Paternal Great-Uncle","Paternal Uncle","Sister","Sister-in-law","Son","Son-in-law","Stepbrother","Stepfather","Stepsister","Stepmother","Wife"],lottoSettingsValues:[],selectedCode:null,selectedMember:null,memberFields:{won:"Won",batch_number:"Batch",name:"Name",email:"Email",age:"Age",gender:"Gender",phone:"Phone",city:"City",subcity:"Subcity",woreda:"Woreda",respondentName:"Respondent",respondent_phone:"Respondent Phone",respondent_relation:"Respondent Relation",heir_name:"Heir",heir_phone:"Heir Phone",heir_relation:"Heir Relation",addedAt:"Added Date",addedBy:"Added By",lastDate:"Last Lotto Date"},selectedSupervisor:null,headers:[{text:"Name",value:"name"},{text:"Phone Number",value:"phone"},{text:"Age",value:"age"},{text:"Gender",value:"gender"},{text:"Batch",value:"batch_number"},{text:"Added",value:"addedAt"},{text:"",value:"actions",sortable:!1}],confirmDeleteDialog:!1,confirmVerifyDialog:!1,editUserMode:!1,addDialog:!1,addFormValid:!1,addPhoneFormValid:!1,newUser:{},alreadyWon:!1,penalized:!1,penalizedAmount:0,newDeposit:{id:null,amount:0,depositedBy:null,depositedAt:null,dailyContribution:null,lottoNumber:null},BackIDisUploading:!1,BackIDUploadStarted:!1,BackIDUploadTask:null,BackIDProgress:null,BackIDisDeleting:!1,BackIDImageType:null,BackIDpaused:!1,BackIDcancelled:!1,BackIDresumed:!1,FrontIDisUploading:!1,FrontIDUploadStarted:!1,FrontIDUploadTask:null,FrontIDProgress:null,FrontIDisDeleting:!1,FrontIDImageType:null,FrontIDpaused:!1,FrontIDcancelled:!1,FrontIDresumed:!1,BATCH_SIZE:1e3,lastKey:0,rules:{required:function(e){return!!e||"*Required."},phoneNumberRule:function(e){return/^[79]\d{8}$/.test(e)||"Phone number must start with 9 or 7 and be a 9-digit number."}}}},watch:{batch_number:"fetchDataForSelectedPot",search:function(e){var t=this;this.filteredUser=""===e?this.User:this.User.filter((function(n){var r=n[t.searchColumn];return r&&r.toString().toLowerCase().includes(e.toString().toLowerCase())}))}},methods:{setSnackbarMessage:function(e){this.snackbar=!0,this.snackBarText=e},valueFormatter:function(e,t){return t},displayFullMemberInfo:function(e){console.log(e),this.selectedMember=e,this.displayInfoDialog=!0},depositContribution:function(e){if(e.lastDate){this.daysAheadOfToday(e.lastDate);console.log(e)}this.selectedMember=e,console.log(this.selectedMember),this.depositContributionDialog=!0},formatDate:function(e){return Object(D.a)(new Date(e),"MMM dd,yyyy")},formatTime:function(e){return Object(D.a)(new Date(e),"HHmmss")},editUser:function(e){this.editUserMode=!0,this.newUser=e,this.showUserForm(),console.log(this.newUser.id)},deleteUser:function(e){this.confirmDeleteUser(e)},verifyUser:function(e){this.confirmVerifyUser(e)},showAddUserForm:function(){this.editUserMode=!1,this.newUser={},this.showUserForm()},showUserForm:function(){this.UserFormValid=!1,this.addDialog=!0},closeUserForm:function(){this.addDialog=!1,this.editUserMode=!1},daysAheadOfToday:function(e){if(null==e)return 0;var t,n=e.slice(0,3);9===e.length?t=parseInt(e.slice(3,5),10):8===e.length?t=parseInt(e.slice(3,4),10):console.log("Invalid formatted date length");var r=parseInt(e.slice(-4),10),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(n),l=new Date(r,o,t)-new Date;return Math.ceil(l/864e5)},performDeposit:function(){var e=this;return Object(T.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,c,h,d,f,_,m,v,y,w,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.depositing=!0,e.penalized=!1,e.depositingRollNumber=0,n=e.selectedMember.lastDate,r=parseInt(e.siteSettingsValues.mindd),o=parseInt(e.siteSettingsValues.maxdd),l=parseInt(e.siteSettingsValues.maxdp),c=parseInt(e.siteSettingsValues.maxdw),h=parseInt(e.siteSettingsValues.sf),d=parseInt(e.siteSettingsValues.apm),j.default.database().ref("Members").child(e.selectedMember.id).once("value",(function(t){return t.exists()?e.daysAheadOfToday(n)<-1*c?(e.setSnackbarMessage("This user has been disallowed to deposit (".concat(c," days passed)")),e.depositing=!1,!1):void(1==t.val().won?(e.newDeposit.dailyContribution=e.siteSettingsValues.dca,e.alreadyWon=!0,e.daysAheadOfToday(n)<-1*l&&(e.setSnackbarMessage("This user has been penalized (".concat(l," days passed)")),e.penalized=!0,e.penalizedAmount=d*e.daysAheadOfToday(n)*-1)):(e.newDeposit.dailyContribution=e.siteSettingsValues.dcb,h=0,e.alreadyWon=!1)):(e.newDeposit.dailyContribution=e.siteSettingsValues.dcb,e.alreadyWon=!1,e.depositing=!1,e.setSnackbarMessage("This user does not exist!"),e.closeMemberInfo(),!1)})),e.depositing){t.next=14;break}return t.abrupt("return",!1);case 14:if(null==e.newDeposit.dailyContribution||0==e.newDeposit.amount){t.next=60;break}if(f=parseInt(e.newDeposit.amount),_=parseInt(e.newDeposit.dailyContribution),m=f/_,v=f,e.alreadyWon&&(m=Math.floor((f-e.penalizedAmount)/(_+h)),v=f-e.penalizedAmount,console.log(m),console.log(v)),v%(_+h)!=0){t.next=55;break}if(console.log("divisibile"),e.alreadyWon){t.next=29;break}if(!(v/_<r)){t.next=27;break}return e.setSnackbarMessage("Minimum amount required is: ".concat(r*_," ")),e.depositing=!1,t.abrupt("return",!1);case 27:t.next=39;break;case 29:if(!(v/(_+h)>=o)){t.next=35;break}return e.setSnackbarMessage("Maximum amount posssible is: ".concat(o*(_+h)+e.penalizedAmount," ")),e.depositing=!1,t.abrupt("return",!1);case 35:if(!(v/(_+h)<30)){t.next=39;break}return e.setSnackbarMessage("You need to cover the penality days: 30 (1 month) "),e.depositing=!1,t.abrupt("return",!1);case 39:if(y=e.lottoSettingsValues.find((function(t){return t.batch_number===e.selectedMember.batch_number})),w=null,O=null,y?(console.log(y),w=parseInt(y.rollNumber),O=parseInt(y.currentLottoNumber)):(console.log("Object not found"),w=0,O=0),e.totalLottoTogenerate=m,w!=O&&!e.alreadyWon){t.next=51;break}return t.next=47,e.loopLottoUpdate(e.penalizedAmount,n,m,e.depositingRollNumber,w,e.selectedMember,v-h*m,_,e.currentUser);case 47:e.depositing=t.sent,e.closeMemberInfo(),t.next=53;break;case 51:console.log("not equal"),e.depositing=!1;case 53:t.next=58;break;case 55:console.log("not divisibile"),e.penalizedAmount>0?e.setSnackbarMessage("(Penalized ".concat(e.penalizedAmount,") ").concat(v," is not divisibile by ").concat(_+h,". Try ").concat(30*(_+h)+e.penalizedAmount)):e.setSnackbarMessage("".concat(v," is not divisibile by ").concat(_+h,". Try products of ").concat(_+h)),e.depositing=!1;case 58:t.next=64;break;case 60:e.depositing=!1,console.log(e.newDeposit.amount),console.log(e.newDeposit.dailyContribution),0==e.newDeposit.amount||null==e.newDeposit.amount?e.setSnackbarMessage("Please enter a valid number to process deposit"):e.setSnackbarMessage("Please reload this page and try again. If issue persists contact your administrator");case 64:case"end":return t.stop()}}),t)})))()},loopLottoUpdate:function(e,t,n,r,o,l,c,h,d){var f=this;return Object(T.a)(regeneratorRuntime.mark((function _(){var m,data;return regeneratorRuntime.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:return _.prev=0,_.next=3,fetch("".concat(f.siteSettingsValues.su,"/processDeposit"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({winner:f.alreadyWon,penalityAmount:e,amount:c,selectedMember:l,currentUser:d,lastDate:t,totalLottoTogenerate:n,depositingRollNumber:r,currentRollNumber:o,dailyContribution:h})});case 3:if((m=_.sent).ok){_.next=6;break}throw new Error("HTTP error! Status: ".concat(m.status));case 6:return _.next=8,m.json();case 8:if(data=_.sent,f.setSnackbarMessage(data.message),!data.success){_.next=12;break}return _.abrupt("return",!1);case 12:_.next=19;break;case 14:return _.prev=14,_.t0=_.catch(0),console.error("Error updating deposit:",_.t0),f.setSnackbarMessage(_.t0),_.abrupt("return",!1);case 19:case"end":return _.stop()}}),_,null,[[0,14]])})))()},fetchMembers:function(){var e=this;return Object(T.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,fetch("http://localhost:3006/fetchMembers",{method:"GET",headers:{"Content-Type":"application/json"}});case 4:if((n=t.sent).ok){t.next=7;break}throw new Error("HTTP error! Status: ".concat(n.status));case 7:return t.next=9,n.json();case 9:data=t.sent,e.User=data.members,e.filteredUser=e.User,console.log(e.filteredUser[0]),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),console.error("Error fetching members:",t.t0),e.setSnackbarMessage(t.t0);case 19:e.loading=!1;case 20:case"end":return t.stop()}}),t,null,[[1,15]])})))()},saveUser:function(){var e=this;if(this.$refs.UserForm.validate()){var t=this.editUserMode?this.getUpdatedUserData():this.getNewUserData();fetch("".concat(this.server_url,"/saveMember"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:t,edit:this.editUserMode,memberId:this.newUser.id})}).then((function(e){if(!e.ok)throw new Error(e.message);return e.json()})).then((function(data){console.log("User saved successfully:",data),e.setSnackbarMessage(data.message),e.closeUserForm()})).catch((function(t){console.error("Error saving user:",t.message),e.setSnackbarMessage(t.message)}))}},getUpdatedUserData:function(){return{batch_number:this.newUser.batch_number,name:this.newUser.name,phone:this.newUser.phone,age:this.newUser.age,gender:this.newUser.gender,profile_pic:this.newUser.profile_pic,id_front:this.newUser.id_front,id_back:this.newUser.id_back,city:this.newUser.city,subcity:this.newUser.subcity,woreda:this.newUser.woreda,house_number:this.newUser.house_number,respondent_name:this.newUser.respondent_name,respondent_phone:this.newUser.respondent_phone,respondent_relation:this.newUser.respondent_relation,heir_name:this.newUser.heir_name,heir_phone:this.newUser.heir_phone,heir_relation:this.newUser.heir_relation,updatedAt:Date.now(),updatedBy:this.currentUser.userId}},getNewUserData:function(){return{batch_number:this.newUser.batch_number,name:this.newUser.name,phone:this.newUser.phone,age:this.newUser.age,gender:this.newUser.gender,id_front:this.newUser.id_front,id_back:this.newUser.id_back,city:this.newUser.city,subcity:this.newUser.subcity,woreda:this.newUser.woreda,house_number:this.newUser.house_number,respondent_name:this.newUser.respondent_name,respondent_phone:this.newUser.respondent_phone,respondent_relation:this.newUser.respondent_relation,heir_name:this.newUser.heir_name,heir_phone:this.newUser.heir_phone,heir_relation:this.newUser.heir_relation,winAmount:this.siteSettingsValues.dwa,won:!1,online:!1,addedAt:Date.now(),addedBy:this.currentUser.userId}},confirmDeleteUser:function(e){this.UserToDelete=e,this.confirmDeleteDialog=!0},confirmVerifyUser:function(e){this.UserToVerify=e,this.confirmVerifyDialog=!0},confirmDelete:function(){var e=this;return Object(T.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(e.server_url,"/deleteMember/").concat(e.UserToDelete.id),{method:"DELETE"});case 3:if((n=t.sent).ok){t.next=6;break}throw new Error("Failed to delete member");case 6:return t.next=8,n.json();case 8:data=t.sent,console.log("Member deleted successfully:",data.message),e.setSnackbarMessage(data.message),e.confirmDeleteDialog=!1,e.filteredUser=e.User.filter((function(t){return t.id!==e.UserToDelete.id})),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("Error deleting member:",t.t0.message),e.setSnackbarMessage(t.t0.message);case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))()},cancelDelete:function(){this.closeDeleteDialog()},closeMemberInfo:function(){this.depositing=!1,this.displayInfoDialog=!1,this.depositContributionDialog=!1,this.selectedMember=null},closeDeleteDialog:function(){this.confirmDeleteDialog=!1,this.UserToDelete=null},getCurrentDateFormatted:function(){var e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)},getDatePathFormatted:function(e){var t=e.slice(-4),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(e.slice(0,3)),r=e.slice(3,5);return"".concat(t,"-").concat(String(n+1).padStart(2,"0"),"-").concat(r)},exportToExcel:function(){var data=this.filteredUser.map((function(e){return{Name:e.name,Phone:e.phone,Age:e.age,Gender:e.gender,City:e.city,Subcity:e.subcity,Woreda:e.woreda,"House Number":e.house_number,"Respondent Name":e.respondent_name,"Respondent Phone":e.respondent_phone,"Respondent Relation":e.respondent_relation,"Heir Name":e.heir_name,"Heir Phone":e.heir_phone,"Heir Relation":e.heir_relation,"Added At":e.addedAt}})),e=M.a.json_to_sheet(data),t=M.a.book_new();M.a.book_append_sheet(t,e,"Members"),Object(M.b)(t,"Members.xlsx")},showAddForm:function(){this.addDialog=!0},closeAddForm:function(){this.addDialog=!1,this.newUser={}}}},F=(n(869),n(100)),component=Object(F.a)(A,(function(){var e=this,t=e._self._c;return t("div",[t(k.a,{attrs:{timeout:e.timeout},scopedSlots:e._u([{key:"actions",fn:function(){return[t(r.a,{attrs:{color:"pink",variant:"text"},on:{click:function(t){e.snackbar=!1}}},[e._v("\n      Close\n    ")])]},proxy:!0}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n  "+e._s(e.snackBarText)+"\n\n  ")]),e._v(" "),t("div",{staticClass:"my-5",staticStyle:{display:"flex",margin:"auto"}},[t(S.a,[t(c.a,{attrs:{align:"center",cols:"12",md:"3",sm:"3"}},[t(x.a,{attrs:{outlined:"",dense:"",items:e.headers,label:"Column"},model:{value:e.searchColumn,callback:function(t){e.searchColumn=t},expression:"searchColumn"}})],1),e._v(" "),t(c.a,{attrs:{align:"center",cols:"12",md:"6",sm:"6"}},[t(P.a,{attrs:{dense:"",outlined:"","append-icon":"mdi-magnify",label:"Search","single-line":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),t(c.a,{attrs:{align:"center",cols:"12",md:"3",sm:"3"}},[e.userHasPermission?t(r.a,{staticStyle:{"background-color":"#183D0E",color:"#FFC72C"},on:{click:e.showAddForm}},[e._v("Add")]):e._e()],1)],1)],1),e._v(" "),t(h.a,{attrs:{loading:e.loading,headers:e.headers,items:e.filteredUser,search:e.search,"footer-props":{"items-per-page-options":[10,20,30],"show-current-page":!0,"show-text":!0,"show-select":!0,align:"center"}},scopedSlots:e._u([{key:"item.actions",fn:function(n){var o=n.item;return[null!=e.userRole&&"Banker"!=e.userRole?t(r.a,{staticClass:"ma-1",attrs:{fab:"",small:"",inline:""},on:{click:function(t){return e.editUser(o)}}},[t(_.a,{attrs:{color:"green"}},[e._v("mdi-pencil")])],1):e._e(),e._v(" "),null!=e.userRole&&"Banker"!=e.userRole?t(r.a,{staticClass:"ma-1",attrs:{fab:"",small:"",inline:""},on:{click:function(t){return e.deleteUser(o)}}},[t(_.a,{attrs:{color:"red"}},[e._v("mdi-delete")])],1):e._e(),e._v(" "),t(r.a,{staticClass:"ma-1",attrs:{fab:"",small:"",inline:""},on:{click:function(t){return e.displayFullMemberInfo(o)}}},[t(_.a,{attrs:{color:"blue"}},[e._v("mdi-information")])],1),e._v(" "),null!=e.userRole&&"Agent"!=e.userRole?t(r.a,{staticClass:"ma-1",attrs:{fab:"",small:"",inline:""},on:{click:function(t){return e.depositContribution(o)}}},[t(_.a,{attrs:{color:"green"}},[e._v("mdi-bank")])],1):e._e()]}}])}),e._v(" "),t(r.a,{attrs:{disabled:e.loading,color:"primary"},on:{click:e.exportToExcel}},[e._v("Export to Excel")]),e._v(" "),t(d.a,{attrs:{"max-width":"600px"},model:{value:e.addDialog,callback:function(t){e.addDialog=t},expression:"addDialog"}},[t(o.a,[t(l.d,{staticClass:"bold-center",staticStyle:{"margin-bottom":"1%"}},[e._v("\n                "+e._s(e.editUserMode?"Edit Member":"Add Member")+"\n            ")]),e._v(" "),t(l.c,[t(f.a,{ref:"UserForm",attrs:{"lazy-validation":""},model:{value:e.addFormValid,callback:function(t){e.addFormValid=t},expression:"addFormValid"}},[t(S.a,[t(x.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Batch",items:e.potOptions},model:{value:e.newUser.batch_number,callback:function(t){e.$set(e.newUser,"batch_number",t)},expression:"newUser.batch_number"}})],1),e._v(" "),t(l.b,{staticClass:"label text-grey-darken-2 bold-center"},[e._v("Personal")]),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Name"},model:{value:e.newUser.name,callback:function(t){e.$set(e.newUser,"name",t)},expression:"newUser.name"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Phone"},model:{value:e.newUser.phone,callback:function(t){e.$set(e.newUser,"phone",t)},expression:"newUser.phone"}})],1)],1),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Age"},model:{value:e.newUser.age,callback:function(t){e.$set(e.newUser,"age",t)},expression:"newUser.age"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[t(x.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Gender",items:e.genderOptions},model:{value:e.newUser.gender,callback:function(t){e.$set(e.newUser,"gender",t)},expression:"newUser.gender"}})],1)],1),e._v(" "),e.editUserMode?t(S.a,[t(c.a,[e.newUser.profile_pic?t(o.a,{attrs:{outlined:""}},[t(m.a,{attrs:{width:"20%",height:"30%",src:e.getProfileImageUrl}})],1):e._e(),e._v(" "),t(o.a,{attrs:{disabled:e.loading}},[t("ImageUpload",{attrs:{label:"Profile Picture",uploadUrl:e.server_url,memberId:e.newUser.id,imageName:"profile_pic"}})],1)],1)],1):e._e(),e._v(" "),e.editUserMode?t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[e.newUser.id_front?t(o.a,{attrs:{outlined:""}},[t(m.a,{attrs:{width:"20%",height:"30%",src:e.getIDFrontImageUrl}})],1):e._e(),e._v(" "),t(o.a,{attrs:{disabled:e.loading}},[t("ImageUpload",{attrs:{label:"Front ID",uploadUrl:e.server_url,memberId:e.newUser.id,imageName:"id_front"}})],1)],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[e.newUser.id_back?t(o.a,{attrs:{outlined:""}},[t(m.a,{attrs:{width:"20%",height:"30%",src:e.getIDBackImageUrl}})],1):e._e(),e._v(" "),t(o.a,{attrs:{disabled:e.loading}},[t("ImageUpload",{attrs:{label:"Back ID",uploadUrl:e.server_url,memberId:e.newUser.id,imageName:"id_back"}})],1)],1)],1):e._e(),e._v(" "),t(l.b,{staticClass:"label text-grey-darken-2 bold-center"},[e._v("Address")]),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"City"},model:{value:e.newUser.city,callback:function(t){e.$set(e.newUser,"city",t)},expression:"newUser.city"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Subcity"},model:{value:e.newUser.subcity,callback:function(t){e.$set(e.newUser,"subcity",t)},expression:"newUser.subcity"}})],1)],1),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Woreda"},model:{value:e.newUser.woreda,callback:function(t){e.$set(e.newUser,"woreda",t)},expression:"newUser.woreda"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"House Number"},model:{value:e.newUser.house_number,callback:function(t){e.$set(e.newUser,"house_number",t)},expression:"newUser.house_number"}})],1)],1),e._v(" "),t(l.b,{staticClass:"label text-grey-darken-2 bold-center"},[e._v("Respondent")]),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Name"},model:{value:e.newUser.respondent_name,callback:function(t){e.$set(e.newUser,"respondent_name",t)},expression:"newUser.respondent_name"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Phone"},model:{value:e.newUser.respondent_phone,callback:function(t){e.$set(e.newUser,"respondent_phone",t)},expression:"newUser.respondent_phone"}})],1)],1),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(x.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Relation",items:e.familyRelations},model:{value:e.newUser.respondent_relation,callback:function(t){e.$set(e.newUser,"respondent_relation",t)},expression:"newUser.respondent_relation"}})],1)],1),e._v(" "),t(l.b,{staticClass:"label text-grey-darken-2 bold-center"},[e._v("Heir")]),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Name"},model:{value:e.newUser.heir_name,callback:function(t){e.$set(e.newUser,"heir_name",t)},expression:"newUser.heir_name"}})],1),e._v(" "),t(c.a,{attrs:{cols:"12",sm:"6"}},[t(P.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Phone"},model:{value:e.newUser.heir_phone,callback:function(t){e.$set(e.newUser,"heir_phone",t)},expression:"newUser.heir_phone"}})],1)],1),e._v(" "),t(S.a,[t(c.a,{attrs:{cols:"12",sm:"6"}},[t(x.a,{attrs:{rules:[e.rules.required],outlined:"",dense:"",label:"Relation",items:e.familyRelations},model:{value:e.newUser.heir_relation,callback:function(t){e.$set(e.newUser,"heir_relation",t)},expression:"newUser.heir_relation"}})],1)],1)],1)],1),e._v(" "),t(l.a,[t(I.a),e._v(" "),t(r.a,{attrs:{color:"grey darken-2",text:""},on:{click:e.closeAddForm}},[e._v("Cancel")]),e._v(" "),t(r.a,{attrs:{color:"blue darken-1",text:"",disabled:!e.addFormValid},on:{click:e.saveUser}},[e._v("Submit")])],1)],1)],1),e._v(" "),e.selectedMember?t(d.a,{attrs:{"max-width":"80%",persistent:""},model:{value:e.displayInfoDialog,callback:function(t){e.displayInfoDialog=t},expression:"displayInfoDialog"}},[t(o.a,[t(l.d,{staticClass:"headline"},[e._v("\n            Member Information "),e.selectedMember.won?t(_.a,{attrs:{color:"green"}},[e._v("mdi-check-decagram")]):e._e()],1),e._v(" "),t(l.c,[t(v.a,[t(O.a,e._l(e.memberFields,(function(n,r){return e.selectedMember[r]?t(y.a,{key:r},[t(w.a,[t(w.b,[t("strong",[e._v(e._s(n)+":")]),e._v(" "+e._s(e.valueFormatter(r,e.selectedMember[r]))+"\n                    ")])],1)],1):e._e()})),1)],1)],1),e._v(" "),t(l.a,[t(I.a),e._v(" "),t(r.a,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeMemberInfo}},[e._v("Close")])],1)],1)],1):e._e(),e._v(" "),e.selectedMember?t(d.a,{attrs:{"max-width":"50%",persistent:""},model:{value:e.depositContributionDialog,callback:function(t){e.depositContributionDialog=t},expression:"depositContributionDialog"}},[t(o.a,[t(l.d,{staticClass:"headline"},[e._v("\n                Deposit Contribution\n            ")]),e._v(" "),t(l.c,[t(P.a,{attrs:{outlined:"",dense:"",label:"Enter Amount",type:"number"},model:{value:e.newDeposit.amount,callback:function(t){e.$set(e.newDeposit,"amount",t)},expression:"newDeposit.amount"}}),e._v(" "),t("div",{staticStyle:{"align-items":"center"}},[e.depositing&&!e.alreadyWon?t("strong",{staticStyle:{width:"100%","text-align":"center"}},[e._v("Generating "+e._s(e.totalLottoTogenerate)+" lotto numbers")]):e._e(),e._v(" "),e.depositing?t(C.a,{staticStyle:{width:"100%",margin:"auto",color:"#183D0E"},attrs:{align:"center",indeterminate:""}}):e.depositing?e._e():t(r.a,{staticStyle:{"background-color":"#183D0E",color:"#FFC72C",width:"100%"},on:{click:e.performDeposit}},[e._v("Deposit")])],1)],1),e._v(" "),e.depositing?e._e():t(l.a,[t(r.a,{staticStyle:{width:"100%"},attrs:{color:"blue darken-1",text:""},on:{click:e.closeMemberInfo}},[e._v("Close")])],1)],1)],1):e._e(),e._v(" "),t(d.a,{attrs:{"max-width":"400px"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[t(o.a,[t(l.d,{staticClass:"headline centered-title",staticStyle:{"background-color":"#ff5722","margin-bottom":"1%"}},[e._v("\n            Confirm Deletion\n        ")]),e._v(" "),t(l.c,[e._v("\n            Are you sure you want to delete this User?\n        ")]),e._v(" "),t(l.a,[t(I.a),e._v(" "),t(r.a,{attrs:{color:"blue darken-1",text:""},on:{click:e.cancelDelete}},[e._v("Cancel")]),e._v(" "),t(r.a,{attrs:{color:"red darken-1",text:""},on:{click:e.confirmDelete}},[e._v("Delete")])],1)],1)],1)],1)}),[],!1,null,"281ea13b",null);t.default=component.exports;installComponents(component,{ImageUpload:n(810).default})}}]);